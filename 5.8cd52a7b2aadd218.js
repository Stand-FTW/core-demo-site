"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5],{50076:(j,p,t)=>{var i,a,r,c;t.d(p,{GW:()=>r,oK:()=>i}),(a=i||(i={})).Prompt="PROMPT",a.Camera="CAMERA",a.Photos="PHOTOS",function(a){a.Rear="REAR",a.Front="FRONT"}(r||(r={})),function(a){a.Uri="uri",a.Base64="base64",a.DataUrl="dataUrl"}(c||(c={}))},60264:(j,p,t)=>{t.r(p),t.d(p,{HomePageModule:()=>P});var i=t(70655),r=t(98274),c=t(36895),a=t(24006),v=t(48058),N=t(92216),I=t(83111),L=t(35593),B=t(12453),M=t(21327),$=t(91795),H=t(1997),w=t(24382),D=t(52054),S=t(39528),f=t(15861);var F=t(50727),U=t(81067),V=t(47423);t(50076);const C=(0,V.fo)("Camera",{web:()=>t.e(3954).then(t.bind(t,63954)).then(l=>new l.CameraWeb)});var K=t(59136),Q=t(89535),u=t(80529),o=t(99038);let g=class{constructor(s){this.http=s}listSelf(){return this.http.get(`${o.Hz.baseURL}/notificacoes`,{responseType:"json"})}listByUser(s){return this.http.get(`${o.Hz.baseURL}/notificacoes/${s}`,{responseType:"json"})}markAsReadById(s){return this.http.patch(`${o.Hz.baseURL}/notificacoes/${s}/read`,{responseType:"json"})}markAsUnreadById(s){return this.http.patch(`${o.Hz.baseURL}/notificacoes/${s}/unread`,{responseType:"json"})}};g.ctorParameters=()=>[{type:u.eN}],g=(0,i.gn)([(0,r.GSi)({providedIn:"root"})],g);var W=t(34758),d=t(24658);var b=t(34057),k=t(59256),O=t(45088),X=t(69675),E=t(55583),z=t(40199);let x=class{constructor(s){this.http=s}list(s,n=new z.k){let e=E.t.getPageOptionsParams(n);return s&&(s.created_at&&(e=e.append("created_at",s.created_at.toDateString())),s.max_cash_out&&(e=e.append("max_cash_out",s.max_cash_out)),s.min_cash_out&&(e=e.append("min_cash_out",s.min_cash_out)),s.max_cash_in&&(e=e.append("max_cash_in",s.max_cash_in)),s.min_cash_in&&(e=e.append("min_cash_in",s.min_cash_in)),s.max_cash_out&&(e=e.append("max_cash_out",s.max_cash_out)),s.min_cash_out&&(e=e.append("min_cash_out",s.min_cash_out)),s.max_cash_total&&(e=e.append("max_cash_total",s.max_cash_total)),s.min_cash_total&&(e=e.append("min_cash_total",s.min_cash_total))),this.http.get(`${o.Hz.baseURL}/financeiro/tesourarias/empresa/list`,{responseType:"json",params:e})}findById(s){return this.http.get(`${o.Hz.baseURL}/financeiro/tesourarias/empresa/${s}`,{responseType:"json"})}findByDate(s=new Date(o.zr)){const n=(new u.LE).set("date",s.toDateString());return this.http.get(`${o.Hz.baseURL}/financeiro/tesourarias/empresa/`,{responseType:"json",params:n})}};x.ctorParameters=()=>[{type:u.eN}],x=(0,i.gn)([(0,r.GSi)({providedIn:"root"})],x);let y=class{constructor(s){this.http=s}list(s,n=new z.k){let e=E.t.getPageOptionsParams(n);return s&&(s.created_at&&(e=e.append("created_at",s.created_at.toDateString())),s.loja_id&&(e=e.append("loja_id",s.loja_id)),s.max_cash_out&&(e=e.append("max_cash_out",s.max_cash_out)),s.min_cash_out&&(e=e.append("min_cash_out",s.min_cash_out)),s.max_cash_in&&(e=e.append("max_cash_in",s.max_cash_in)),s.min_cash_in&&(e=e.append("min_cash_in",s.min_cash_in)),s.max_cash_out&&(e=e.append("max_cash_out",s.max_cash_out)),s.min_cash_out&&(e=e.append("min_cash_out",s.min_cash_out)),s.max_cash_total&&(e=e.append("max_cash_total",s.max_cash_total)),s.min_cash_total&&(e=e.append("min_cash_total",s.min_cash_total))),this.http.get(`${o.Hz.baseURL}/financeiro/tesourarias/loja/list`,{responseType:"json",params:e})}findById(s){return this.http.get(`${o.Hz.baseURL}/financeiro/tesourarias/loja/${s}`,{responseType:"json"})}findByLojaAndDate(s,n=new Date(o.zr)){const e=(new u.LE).set("loja_id",s).set("date",n.toDateString());return this.http.get(`${o.Hz.baseURL}/financeiro/tesourarias/loja`,{responseType:"json",params:e})}};y.ctorParameters=()=>[{type:u.eN}],y=(0,i.gn)([(0,r.GSi)({providedIn:"root"})],y);var Y=t(9683),q=t(97560),_=t(40363);let h=class{constructor(s,n,e,m,R,A,is,os,rs,cs,ds,ls,ps,ms){this.route=s,this.storage=n,this.usersService=e,this.notificacaoService=m,this.toastService=R,this.modal=A,this.contasColaboradorService=is,this.tesourariasService=os,this.tesourariasEmpresaService=rs,this.preferencesService=cs,this.dashboardUtilsService=ds,this.emailService=ls,this.platform=ps,this.alertController=ms,this.notificacoes=[],this.subscriptions=new F.w0}ngOnInit(){this.itemsNotificacao=[{label:"Op\xe7\xf5es",items:[{label:"Atualizar",icon:"pi pi-fw pi-refresh",command:()=>{this.loadNotificacoes()}}]}],this.itemsUsers=[{label:"Op\xe7\xf5es",items:[{label:"Atualizar",icon:"pi pi-fw pi-refresh",command:()=>{this.loadUsers()}}]}],this.user=this.storage.getCompleteLocalUser(),this.loadUsers(),this.loadNotificacoes(),this.loadMiniDash()}ngOnDestroy(){this.subscriptions.unsubscribe()}ionViewDidEnter(){var s=this;return(0,f.Z)(function*(){const n=s.platform.platforms();(n.includes("android")||n.includes("ios"))&&(yield s.requestCameraPermission())})()}loadNotificacoes(){const s=this.notificacaoService.listSelf().subscribe(n=>{this.notificacoes=n});this.subscriptions.add(s)}loadUsers(s=1){const n=this.usersService.listUsers({loja_id:this.user.loja.id},{order:K.L.ASC,page:s,take:10}).subscribe(e=>{e.data=e.data.filter(m=>m.id!==this.user.id),this.users=e});this.subscriptions.add(n)}paginar(s){const n=s.page+1;this.loadUsers(n)}getNotificacaoIcon(s){return class J{static getIconByTipo(s){switch(s){case d.S.CARGA:return"pi pi-cloud-upload";case d.S.MENSAGEM_COMUM:return"pi pi-envelope";case d.S.MENSAGEM_PRIORITARIA:return"pi pi-info-circle";case d.S.MENSAGEM_PROGRAMADA:return"pi pi-directions";default:return"pi pi-comment"}}}.getIconByTipo(s.tipo)}getNotificacaoColor(s){switch(s){case d.c.AVISO:return"text-yellow-500";case d.c.ERRO:return"text-pink-500";case d.c.INFO:return"text-blue-500";case d.c.SUCESSO:return"text-green-500";default:return"text-blue-500"}}loadMiniDash(){const{nome:s}=this.user.perfil;switch(s){case b.u.COLABORADOR:this.loadContaColaborador();break;case b.u.SUPERVISOR:this.loadTesourariaLoja();break;case b.u.GERENTE:case b.u.ADMIN:this.loadTesourariaEmpresa();break;default:this.simplesDash=void 0}}openPerfil(){this.showModal(O.E,{user:this.user,enableMessageAndNotification:!0})}openMembro(s){this.showModal(O.E,{user:s})}goToPDV(){this.route.navigateByUrl("pdv")}goToPrestacaoServico(){}goToAssinatura(){}goToSendEmail(s){this.emailService.addEmailToList(s.email);this.route.navigate(["/comunicacao-email"],{queryParams:{tab:"email-send"}})}getTheme(){const s=this.preferencesService.getThemePreference();return this.inAndOutDash.backgroundColor=this.preferencesService.surfaceBackground,"dark"==s?s:void 0}requestCameraPermission(){var s=this;return(0,f.Z)(function*(){try{const n=yield C.checkPermissions();if(console.log(`Permiss\xf5es \xe0 c\xe2mera: ${n}`),"granted"!=n.camera||"granted"!=n.photos){const e=yield s.alertController.create({header:"Permiss\xf5es \xe0 c\xe2mera e galeria",message:"Necess\xe1rio para realizar opera\xe7\xf5es com anexo de encomendas",buttons:["OK"]});yield e.present(),yield e.onDidDismiss(),yield C.requestPermissions({permissions:["camera","photos"]}),yield s.requestFilePermission()}}catch(n){console.error("N\xe3o foi poss\xedvel pedir permiss\xe3o \xe0 c\xe2mera/fotos"),console.error(n)}})()}requestFilePermission(){var s=this;return(0,f.Z)(function*(){try{const n=yield U.fy.checkPermissions();console.log(`Permiss\xf5es \xe0 arquivos: ${n}`);const e=yield s.alertController.create({header:"Permiss\xf5es \xe0 arquivos",message:"Necess\xe1rio para poder salvar arquivos e comprovantes",buttons:["OK"],backdropDismiss:!1});yield e.present(),yield e.onDidDismiss(),yield U.fy.requestPermissions()}catch(n){console.error("N\xe3o foi poss\xedvel pedir permiss\xe3o aos arquivos"),console.error(n)}})()}loadContaColaborador(){const{id:s}=this.user,n=this.contasColaboradorService.findByColaboradorAndDate(s).subscribe({next:e=>{this.simplesDash=this.dashboardUtilsService.convertToSimpleDash(e),this.inAndOutDash=this.dashboardUtilsService.convertToInOutSimpleDash(e)},error:e=>{404==e.status&&this.toastService.clearToast()}});this.subscriptions.add(n)}loadTesourariaLoja(){const{id:s}=this.user.loja,n=this.tesourariasService.findByLojaAndDate(s).subscribe({next:e=>{this.simplesDash=this.dashboardUtilsService.convertToSimpleDash(e),this.inAndOutDash=this.dashboardUtilsService.convertToInOutSimpleDash(e)},error:e=>{404==e.status&&this.toastService.clearToast()}});this.subscriptions.add(n)}loadTesourariaEmpresa(){const s=this.tesourariasEmpresaService.findByDate().subscribe({next:n=>{this.simplesDash=this.dashboardUtilsService.convertToSimpleDash(n),this.inAndOutDash=this.dashboardUtilsService.convertToInOutSimpleDash(n)},error:n=>{404==n.status&&this.toastService.clearToast()}});this.subscriptions.add(s)}showModal(s,n){var e=this;return(0,f.Z)(function*(){const m=yield e.modal.create({component:s,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:n});return m.onDidDismiss().then(R=>{const{data:A}=R;A&&(e.user=e.storage.getCompleteLocalUser())}),yield m.present()})()}};h.ctorParameters=()=>[{type:S.F0},{type:Q.V},{type:W.K},{type:g},{type:k.D},{type:v.IN},{type:X.G},{type:y},{type:x},{type:Y.y},{type:q.z},{type:_.j},{type:v.t4},{type:v.Br}],h=(0,i.gn)([(0,r.wA2)({selector:"app-home",template:'<ion-header [translucent]="true">\n  <ion-toolbar>\n    <ion-buttons slot="start">\n      <ion-menu-button></ion-menu-button>\n    </ion-buttons>\n    <ion-title>Home</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content appScrollTheme>\n  <ng-container *ngIf="user && users">\n    <div class="flex flex-column flex-auto wall-background py-2 h-screen">\n      <div class="surface-section p-5">\n        <div (click)="openPerfil()" class="flex align-items-start flex-column lg:flex-row \n        lg:justify-content-between cursor-pointer">\n          <div class="flex align-items-start flex-column md:flex-row">\n            <img [src]="user.avatar_url" class="mr-5 mb-3 lg:mb-0 default-avatar border-1 border-primary" />\n            <div>\n              <span class="text-900 font-medium text-3xl">{{ user.nome }}</span>\n              <div class="flex align-items-center flex-wrap text-sm">\n                <div class="mr-5 mt-3">\n                  <span class="font-medium text-500">Loja</span>\n                  <div class="text-700 mt-2">{{ user.loja?.nome || "Sem loja definida" }}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class="mt-3 lg:mt-0">\n            <span class="font-medium text-500">{{ user.perfil.nome }}</span>\n          </div>\n        </div>\n      </div>\n\n      <div class="p-5">\n        <div class="grid">\n          <ng-container *ngIf="simplesDash">\n\n            <div class="col-12 lg:col-4 xl:col-4">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round">\n                <div class="flex justify-content-between mb-3">\n                  <div>\n                    <span class="block text-500 font-medium mb-3">Produtos</span>\n                    <div class="text-900 font-medium text-xl">Total (R$): {{ simplesDash.produto_venda_valor |\n                      currency:\'BRL\':\'\' }}</div>\n                  </div>\n                  <div class="flex align-items-center justify-content-center bg-blue-100 border-round cursor-pointer"\n                    style="width:2.5rem;height:2.5rem" (click)="goToPDV()">\n                    <i class="pi pi-shopping-cart text-blue-500 text-xl"></i>\n                  </div>\n                </div>\n                <span class="text-blue-500 font-medium">Quantidade: </span>\n                <span class="text-500">{{ simplesDash.produto_venda_quantidade }}</span>\n              </div>\n            </div>\n            <div class="col-12 lg:col-4 xl:col-4">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round">\n                <div class="flex justify-content-between mb-3">\n                  <div>\n                    <span class="block text-500 font-medium mb-3">Servi\xe7os</span>\n                    <div class="text-900 font-medium text-xl">Total (R$): {{ simplesDash.servico_prestado_valor |\n                      currency:\'BRL\':\'\' }}</div>\n                  </div>\n                  <div class="flex align-items-center justify-content-center bg-orange-100 border-round cursor-pointer"\n                    style="width:2.5rem;height:2.5rem" (click)="goToPrestacaoServico()">\n                    <fa-icon class="text-orange-500 text-xl" style="font-size: 20px;"\n                      [icon]="[\'fas\', \'bell-concierge\']"></fa-icon>\n                  </div>\n                </div>\n                <span class="text-orange-500 font-medium">Quantidade: </span>\n                <span class="text-500">{{ simplesDash.servico_prestado_quantidade }}</span>\n              </div>\n            </div>\n            <div class="col-12 lg:col-4 xl:col-4">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round">\n                <div class="flex justify-content-between mb-3">\n                  <div>\n                    <span class="block text-500 font-medium mb-3">Assinaturas</span>\n                    <div class="text-900 font-medium text-xl">Total (R$): {{ simplesDash.assinatura_venda_valor |\n                      currency:\'BRL\':\'\' }}</div>\n                  </div>\n                  <div class="flex align-items-center justify-content-center bg-green-100 border-round cursor-pointer"\n                    style="width:2.5rem;height:2.5rem" (click)="goToAssinatura()">\n                    <fa-icon class="text-green-500 text-xl" style="font-size: 20px;"\n                      [icon]="[\'fas\', \'file-contract\']"></fa-icon>\n                  </div>\n                </div>\n                <span class="text-green-500 font-medium">Quantidade: </span>\n                <span class="text-500">{{ simplesDash.assinatura_venda_quantidade }}</span>\n              </div>\n            </div>\n\n          </ng-container>\n\n          <ng-container *ngIf="inAndOutDash">\n            <div class="col-12 ">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round">\n                <div class="flex justify-content-center mb-3">\n                  <div echarts [options]="inAndOutDash" [theme]="getTheme()"\n                    style="width: 400px; height: 400px; box-shadow: white"></div>\n                </div>\n              </div>\n            </div>\n          </ng-container>\n\n          <div id="notificacoes" class="col-12 xl:col-6">\n            <div class="surface-card shadow-2 border-round p-4">\n              <div class="flex align-items-center justify-content-between mb-3">\n                <div class="text-900 font-medium text-xl">Notifica\xe7\xf5es</div>\n                <div>\n                  <button pButton pRipple icon="pi pi-ellipsis-v" class="p-button-text p-button-plain p-button-rounded"\n                    (click)="menu.toggle($event)"></button>\n                  <p-menu #menu [popup]="true" [model]="itemsNotificacao" appendTo="body"></p-menu>\n                </div>\n              </div>\n              <ng-container *ngIf="notificacoes">\n                <ul class="list-none p-0 m-0">\n                  <li *ngFor="let n of notificacoes"\n                    class="py-3 border-bottom-1 surface-border flex md:align-items-start md:justify-content-between flex-column md:flex-row">\n                    <div class="flex align-items-start mr-0 lg:mr-5">\n                      <button pButton pRipple type="button" [icon]="getNotificacaoIcon(n)"\n                        class="p-button-rounded p-button-secondary p-button-text mr-3 mt-4"></button>\n                      <div>\n                        <span class="text-900 font-medium block mb-2">{{ n.nome }}</span>\n                        <div class="text-700 mb-2"> {{ n.descricao }}</div>\n                        <a [ngClass]="{\n                          \'warning\' : \'text-yellow-500\', \n                        \'danger\' : \'text-pink-500\', \n                        \'info\' : \'text-blue-500\', \n                        \'success\' : \'text-green-500\'\n                      }[n.status]">\n                          <span>{{ n.status | convertStatus }}</span>\n                        </a>\n                      </div>\n                    </div>\n                    <span class="block text-500 font-medium ml-7 md:ml-5 mt-2 md:mt-0">{{ n.created_at | timeSince\n                      }}</span>\n                  </li>\n                </ul>\n              </ng-container>\n\n              <ng-container *ngIf="!notificacoes || notificacoes.length == 0">\n                <div class="border-circle border-1 border-primary">\n                  <app-attention-surface title="Aten\xe7\xe3o" subtitle="Vazio"\n                    message="Nenhuma notifica\xe7\xe3o encontrada"></app-attention-surface>\n                </div>\n              </ng-container>\n            </div>\n          </div>\n\n          <div id="membros" class="col-12 xl:col-6">\n            <div class="surface-card shadow-2 border-round p-4">\n              <div class="flex justify-content-between align-items-center mb-5">\n                <span class="text-xl text-900 font-medium">Membros da mesma loja</span>\n                <div>\n                  <button pButton pRipple icon="pi pi-ellipsis-v" class="p-button-text p-button-plain p-button-rounded"\n                    (click)="cag.toggle($event)"></button>\n                  <p-menu #cag [popup]="true" [model]="itemsUsers" appendTo="body"></p-menu>\n                </div>\n              </div>\n              <ul class="list-none p-0 m-0">\n                <li *ngFor="let u of users.data;"\n                  class="flex flex-column md:flex-row md:align-items-center md:justify-content-between mb-4">\n                  <div class="flex">\n                    <img [src]="u.avatar_url || \'assets/imgs/outros/default-user.jpg\'"\n                      class="mr-3 avatar border-circle border-1 border-primary" style="width: 45px; height: 45px" />\n                    <div>\n                      <span class="block text-900 font-medium mb-1">{{ u.nome }}</span>\n                      <div class="text-600">{{ u.cargo?.nome || "Sem cargo definido" }}</div>\n                    </div>\n                  </div>\n                  <div class="mt-2 md:mt-0 flex flex-nowrap">\n                    <button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-envelope" (click)="goToSendEmail(u)"></button>\n                    \x3c!--\n                      <button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-comment"></button>\n                    --\x3e\n                    <button pButton pRipple class="p-button-text p-button-plain p-button-rounded mr-1"\n                      icon="pi pi-external-link" (click)="openMembro(u)"></button>\n                  </div>\n                </li>\n              </ul>\n              <p-paginator [rows]="users.meta.take" [totalRecords]="users.meta.itemCount"\n                [pageLinkSize]="users.meta.pageCount" (onPageChange)="paginar($event)"></p-paginator>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </ng-container>\n</ion-content>',styles:["ion-button {\n  min-width: 260px !important;\n  max-width: 260px !important;\n  overflow-wrap: break-word;\n  word-break: break-all;\n}"]})],h);const ss=[{path:"",component:h}];let T=class{};T=(0,i.gn)([(0,r.LVF)({imports:[S.Bz.forChild(ss)],exports:[S.Bz]})],T);var es=t(85226),ts=t(58949),ns=t(98373),as=t(91670);let P=class{};P=(0,i.gn)([(0,r.LVF)({imports:[c.ez,a.u5,v.Pc,L.hJ,$.T,B.EV,M.$9,H.U,w.S,N.uH,I.t,D.Ns.forRoot({echarts:()=>t.e(7386).then(t.bind(t,77386))}),T,es.o,ts.d,ns.L,as.A],declarations:[h]})],P)},35326:(j,p,t)=>{t.d(p,{r:()=>i});class i{static checkIfEmail(c){return/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/gi.test(c)}static ClearSpecialCharacters(c){return!c||c.trim().length<=0?"":c.replace(/[^a-zA-Z0-9]/g,"").trim()}}}}]);