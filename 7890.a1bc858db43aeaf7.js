"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7890],{67890:(Q,C,t)=>{t.r(C),t.d(C,{AdministracaoClientePageModule:()=>Ee});var m=t(70655),d=t(98274),g=t(36895),l=t(24006),u=t(48058),p=t(92216),y=t(39528);let n=class{constructor(){this.currentTab="cliente"}ngOnInit(){}changeTab(e){this.currentTab=e.detail.value}};n.ctorParameters=()=>[],n=(0,m.gn)([(0,d.wA2)({selector:"app-administracao-cliente",template:'<ion-header [translucent]="true">\n  <ion-toolbar>\n    <ion-buttons slot="start">\n      <ion-menu-button></ion-menu-button>\n    </ion-buttons>\n    <ion-title>ADM. Clientes</ion-title>\n  </ion-toolbar>\n</ion-header>\n\n<ion-content appScrollTheme>\n  <br />\n  <ion-segment class="background-segment" [(ngModel)]="currentTab" [ngModelOptions]="{standalone: true}"\n    (ionChange)="changeTab($event)">\n    <ion-segment-button style="margin-left: 5px; max-width: 200px" layout="icon-start" value="cliente">\n      <ion-icon style="font-size: 1.2em" name="id-card-outline"></ion-icon>\n      <ion-label text-wrap class="wrap-text" style="font-size: 1.1em">\n        Clientes\n      </ion-label>\n    </ion-segment-button>\n  </ion-segment>\n  <br />\n\n  <div class="wall-background h-screen">\n    <ng-container *ngIf="currentTab === \'cliente\'">\n      <div style="max-width: 95%; margin: auto">\n        <app-cliente-main></app-cliente-main>\n      </div>\n    </ng-container>\n  </div>\n\n</ion-content>',styles:[""]})],n);const h=[{path:"",component:n}];let r=class{};r=(0,m.gn)([(0,d.LVF)({imports:[y.Bz.forChild(h)],exports:[y.Bz]})],r);var f=t(85226),E=t(44588),le=t(77604),de=t(9764),T=t(51740),P=t(35593),N=t(82210),ce=t(58783),pe=t(63054),U=t(92665),ue=t(1997),Te=t(38433),me=t(50613),R=t(21493),he=t(32137),Ae=t(79512),B=t(91795),G=t(45132),ve=t(15108),Pe=t(68271),$=t(21327),we=t(32506),Xe=t(2635),We=t(81338),Me=t(19901),je=t(42480),Ze=t(50952),Ke=t(68350),w=t(15861);var M=t(50727),c=t(98739),fe=t(57118),Je=t(42759),Ye=t(16320),j=t(59256),J=t(59136),Le=t(52710),Fe=t(68488),Ne=t(94567),Ue=t(41117),_e=t(2870),qe=t(79702);var at=t(37945),Re=t(34758),st=t(36640),Be=t(34057),q=t(95494),nt=t(54452),it=t(67578);let L=class{constructor(e,a,s,i,o,v,I,A,K){this.formBuilder=e,this.userService=a,this.clientesService=s,this.lojaService=i,this.perfilService=o,this.cargoService=v,this.modalCadastro=I,this.toastService=A,this.storage=K,this.isModal=!0,this.updatedEvent=new d.vpe,this.currentPerfilTake=15,this.currentLojasPage=1,this.searchedLoja="",this.isLoaded=!1,this.currentCargosPage=1,this.searchedCargo="",this.searchedSuperior="",this.showSuperiorDialog=!1,this.createdUserId="",this.userWasCreated=!1,this.isCliente=!1,this.maxDate=q.E.getDiaAnterior(),this.subscriptions=new M.w0}ngOnInit(){const{nome:e,loja:a,tel1:s,tel2:i,email_alternativo:o,data_nascimento:v}=this.user,I=a?.id||void 0;this.form=this.formBuilder.group({nome:[e,[l.kI.required]],email_alternativo:[o,[l.kI.email]],tel1:[s,[l.kI.required]],tel2:[i,[]],data_nascimento:[new Date(v),[l.kI.required]],loja_id:[I,[l.kI.required]]}),this.loadLojas()}ngOnDestroy(){this.subscriptions.unsubscribe()}loadLojas(e=1,a){const s=this.lojaService.list({searchedLoja:this.searchedLoja,status_loja:Ne.eX.OPERANDO},{order:J.L.ASC,page:e,take:10}).subscribe(i=>{this.lojas=i,a&&a.show()});this.subscriptions.add(s)}searchLoja({value:e}){this.searchedLoja=e,this.loadLojas(1)}clearLoja(e){e.value="",this.searchedLoja="",this.loadLojas(1)}paginarLojas(e,a){const{first:s,rows:i}=e,o=Number(Number(s)/Number(i)+1);o!=this.currentLojasPage&&(this.currentLojasPage=o,this.loadLojas(o,a))}update(){const{id:e}=this.user,a=this.form.get("nome").value,s=this.form.get("data_nascimento").value,i=this.form.get("email_alternativo").value,o=this.form.get("tel1").value,v=this.form.get("tel2").value,I=this.form.get("loja_id").value,A=this.clientesService.update({nome:a,loja_id:I,data_nascimento:s,email_alternativo:i,tel1:o,tel2:v},e).subscribe(K=>{this.createdUserId=K.id,this.userWasCreated=!0,this.fechar(this.userWasCreated)});this.subscriptions.add(A)}uploadFile(e,a){const{id:s,tipo_user:i}=this.user,{id:o,perfil_nome:v}=this.storage.getLocalUser();if(s!=o&&!it.f.checkUpdateImagePermission(v))return void this.toastService.presentToast({titulo:"N\xe3o autorizado",detalhe:`Apenas ${Be.u.ADMIN} e ${Be.u.GERENTE} podem atualizar essas informa\xe7\xf5es`,duracao:c.m4.mediumDuration,gravidade:c.kl.ATENCAO});const I=e.files[0],A=this.userService.newUploadAvatar(i,I,s).subscribe(K=>{this.user=K,this.createdUserId=K.id,this.userWasCreated=!0,this.toastService.presentToast({detalhe:"Foto alterada",duracao:c.m4.shortDuration,gravidade:c.kl.SUCESSO,titulo:"Sucesso!"}),this.updatedEvent.emit(this.user),a.clear()});this.subscriptions.add(A)}listenEndereco(e){this.fechar(this.userWasCreated)}fechar(e=!1){this.modalCadastro.dismiss(e)}isInputError(e){return!(this.form.controls[e].untouched||!this.form.controls[e].errors)}disableCreateBtn(){return!this.form.valid}showModal(e,a){var s=this;return(0,w.Z)(function*(){const i=yield s.modalCadastro.create({component:e,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:a});return i.onDidDismiss().then(o=>{}),yield i.present()})()}};L.ctorParameters=()=>[{type:l.QS},{type:Re.K},{type:Fe.Y},{type:fe.W},{type:at.F},{type:st.u},{type:u.IN},{type:j.D},{type:nt.V}],L.propDecorators={user:[{type:d.IIB}],isModal:[{type:d.IIB}],updatedEvent:[{type:d.r_U}]},L=(0,m.gn)([(0,d.wA2)({selector:"app-cliente-detail",template:'<ion-content appScrollTheme>\n\n  <form *ngIf="lojas" [formGroup]="form" (ngSubmit)="$event.preventDefault()">\n    <div class="surface-ground px-4 py-8 md:px-6 lg:px-8">\n      <div class="flex flex-column align-items-center flex-or ">\n        <img [src]="user?.avatar_url || \'assets/imgs/outros/default-user.jpg\'"\n          class="h-10rem w-10rem border-circle border-2 border-primary mr-1 xl:mr-0 ml-3 " />\n        <p-fileUpload #avatarFile id="avatar" mode="basic" name="avatar" accept="image/*"\n          styleClass="p-button-rounded -mt-4 w-3rem  text-center" chooseIcon="pi pi-pencil" chooseLabel=" "\n          customUpload="true" [auto]="true" (uploadHandler)="uploadFile($event, avatarFile)">\n        </p-fileUpload>\n      </div>\n\n      <div class="text-900 font-medium text-xl mb-1">Criar/Cadastrar</div>\n      <div class="surface-card p-4 shadow-2 border-round p-fluid">\n        <div class="grid formgrid p-fluid">\n\n          <div class="field mb-4 col-12 md:col-6">\n            <label for="nome" class="font-medium text-900">Nome</label>\n            <input id="nome" placeholder="Nome" type="text" pInputText formControlName="nome">\n            <div class="flex mt-1 justify-content-end">\n              <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'nome\')"></p-message>\n            </div>\n          </div>\n          <div class="field mb-4 col-12 md:col-6">\n            <label for="descricao">Email (alternativo)</label>\n            <input type="text" pInputText placeholder="Email alternativo" formControlName="email_alternativo" />\n            <div class="flex mt-1 justify-content-end">\n              <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'email_alternativo\')"></p-message>\n            </div>\n          </div>\n\n          <div class="field mb-4 col-12 md:col-6">\n            <label for="tel2">Celular Principal</label>\n            <p-inputMask id="tel1" placeholder="Celular do colaborador" formControlName="tel1" mask="(99)9 9999-9999">\n            </p-inputMask>\n            <div class="flex mt-1 justify-content-end">\n              <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'tel1\')"></p-message>\n            </div>\n          </div>\n          <div class="field mb-4 col-12 md:col-6">\n            <label for="tel2">Celular Alternativo</label>\n            <p-inputMask id="tel2" placeholder="Celular alternativo do colaborador" formControlName="tel2"\n              mask="(99)9 9999-9999">\n            </p-inputMask>\n            <div class="flex mt-1 justify-content-end">\n              <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'tel2\')"></p-message>\n            </div>\n          </div>\n\n          <div class="field mb-4 col-12 md:col-6">\n            <label for="data_nascimento">Data de nascimento</label>\n            <p-calendar formControlName="data_nascimento" placeholder="Data de nascimento do colaborador"\n              [maxDate]="maxDate" inputId="data_nascimento" [maxDate]="maxDate"></p-calendar>\n            <div class="flex mt-1 justify-content-end">\n              <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'data_nascimento\')"></p-message>\n            </div>\n          </div>\n          <div class="surface-border border-top-1 opacity-50 mb-4 col-12"></div>\n\n          <div class="col-12 field ">\n            <label for="loja_id" class="text-900 font-medium mb-3">Loja</label>\n            <p-dropdown id="loja_id" [options]="lojas.data" [filter]="true" placeholder="Selecione"\n              [virtualScroll]="true" [virtualScrollItemSize]="38" [lazy]="true" formControlName="loja_id"\n               optionLabel="nome" filterBy="nome,codigo"\n              optionValue="id">\n              <ng-template pTemplate="filter" let-options="options">\n                <div class="flex p-3">\n                  <div class="p-inputgroup" (click)="$event.stopPropagation()">\n                    <input #searchLojaInput type="text" pInputText placeholder="Procurar"\n                      (keyup.enter)="searchLoja(searchLojaInput)">\n                    <button pButton pRipple icon="pi pi-search" (click)="searchLoja(searchLojaInput)"></button>\n                    <button class="p-button-outlined" pButton pRipple icon="pi pi-times"\n                      (click)="clearLoja(searchLojaInput)"></button>\n                  </div>\n                </div>\n              </ng-template>\n              <ng-template pTemplate="loader" let-options="options">\n                <div class="flex align-items-center py-2 px-3" style="height: 38px">\n                  <p-skeleton width="50%" height="1rem"></p-skeleton>\n                </div>\n              </ng-template>\n              <ng-template let-loja pTemplate="item">\n                <div>\n                  <div>[{{ loja.codigo }}] {{ loja.nome}}</div>\n                </div>\n              </ng-template>\n              <ng-template let-loja pTemplate="selectedItem">\n                <div>[{{ loja.codigo }}] {{ loja.nome}}</div>\n              </ng-template>\n            </p-dropdown>\n            <div class="flex mt-1 justify-content-end">\n              <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'loja_id\')"></p-message>\n            </div>\n          </div>\n          <div class="surface-border border-top-1 opacity-50 mb-4 col-12"></div>\n        </div>\n        <div class="flex justify-content-end">\n          <button pButton pRipple label="Atualizar" icon="pi pi-send" iconPos="right" class="w-auto" (click)="update()"\n            [disabled]="disableCreateBtn()"></button>\n        </div>\n      </div>\n    </div>\n  </form>\n\n</ion-content>\n\n<ion-footer>\n  <ion-toolbar>\n    <ion-button expand="full" color="danger" (click)="fechar()">Fechar</ion-button>\n  </ion-toolbar>\n</ion-footer>',styles:[""]})],L);var ge=t(7689),ee=t(9683),te=t(97560),lt=t(65626);let F=class{constructor(e,a,s,i,o){this.toastService=e,this.modalCtrl=a,this.contasClienteService=s,this.dashboardUtilsService=i,this.preferencesService=o,this.selectedDate=new Date,this.hasAccount=!1,this.subscriptions=new M.w0}ngOnInit(){this.loadMiniDash()}ngOnDestroy(){this.subscriptions.unsubscribe()}loadMiniDash(){const{id:e}=this.user,a=this.contasClienteService.findByColaboradorAndDate(e,this.selectedDate).subscribe({next:s=>{this.simplesDash=this.dashboardUtilsService.convertToSimpleDashCliente(s),this.inAndOutDash=this.dashboardUtilsService.convertToInOutSimpleDashCliente(s),this.hasAccount=!0},complete:()=>{this.toastService.clearToast()}});this.subscriptions.add(a)}changeDate(){this.simplesDash=void 0,this.inAndOutDash=void 0,this.hasAccount=!1,this.selectedOption=void 0,this.loadMiniDash()}getTheme(){const{theme:e,dashboard:a}=this.preferencesService.getDashboardTheme(this.inAndOutDash);return this.inAndOutDash=a,e}setUserImage(e){return e.avatar_url||"assets/imgs/outros/default-user.jpg"}goToPedidos(){this.selectedOption=ge.KO.PRODUTO}goToServicos(){this.selectedOption=ge.KO.SERVICO}gotToAssinaturas(){this.selectedOption=ge.KO.ASSINATURA}fechar(e=!1){this.modalCtrl.dismiss(e)}showModal(e,a){var s=this;return(0,w.Z)(function*(){const i=yield s.modalCtrl.create({component:e,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:a});return i.onDidDismiss().then(o=>{const{data:v}=o;v&&s.toastService.presentToast({titulo:"Sucesso",detalhe:"Opera\xe7\xe3o bem sucedida!",duracao:c.m4.mediumDuration,gravidade:c.kl.SUCESSO})}),yield i.present()})()}};F.ctorParameters=()=>[{type:j.D},{type:u.IN},{type:lt.V},{type:te.z},{type:ee.y}],F.propDecorators={user:[{type:d.IIB}]},F=(0,m.gn)([(0,d.wA2)({selector:"app-cliente-profile",template:'<ion-content appScrollTheme>\n  <ng-container *ngIf="user">\n    <div class="flex flex-column flex-auto wall-background py-2 h-screen">\n      <div class="surface-section p-5">\n        <div class="flex align-items-start flex-column lg:flex-row \n        lg:justify-content-between">\n          <div class="flex align-items-start flex-column md:flex-row">\n            <img [src]="setUserImage(user)" class="mr-5 mb-3 lg:mb-0 default-avatar border-1 border-primary" />\n            <div>\n              <span class="text-900 font-medium text-3xl">{{ user.nome }}</span>\n              <div class="flex align-items-center flex-wrap text-sm">\n                <div class="mr-5 mt-3">\n                  <span class="font-medium text-500">Loja</span>\n                  <div class="text-700 mt-2">{{ user.loja?.nome || "Sem loja definida" }}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div class="mt-3 lg:mt-0">\n            <div class="font-medium text-900  mb-1">M\xeas</div>\n            <p-calendar [(ngModel)]="selectedDate" view="month" inputId="dateformat" (onSelect)="changeDate()"\n              dateFormat="MM/yy"></p-calendar>\n          </div>\n        </div>\n      </div>\n\n      <div class="p-5">\n        <div class="grid">\n          <ng-container *ngIf="inAndOutDash">\n            <div class="col-12 ">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round">\n                <div class="flex justify-content-center mb-3 ">\n                  <div class="w-full" echarts [options]="inAndOutDash" [theme]="getTheme()"\n                    style="width: 400px; height: 400px; box-shadow: white"></div>\n                </div>\n              </div>\n            </div>\n          </ng-container>\n\n          <p-divider class="col-12"></p-divider>\n\n          <ng-container *ngIf="simplesDash">\n            <div class="col-12 lg:col-4 xl:col-4">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round cursor-pointer"\n                (click)="goToPedidos()">\n                <div class="flex justify-content-between mb-3">\n                  <div>\n                    <span class="block text-500 font-medium mb-3">Produtos</span>\n                    <div class="text-900 font-medium text-xl">Total (R$): {{ simplesDash.produto_venda_valor |\n                      currency:\'BRL\':\'\' }}</div>\n                  </div>\n                  <div class="flex align-items-center justify-content-center bg-blue-100 border-round"\n                    style="width:2.5rem;height:2.5rem">\n                    <i class="pi pi-shopping-cart text-blue-500 text-xl"></i>\n                  </div>\n                </div>\n                <span class="text-blue-500 font-medium">Quantidade: </span>\n                <span class="text-500">{{ simplesDash.produto_venda_quantidade }}</span>\n              </div>\n            </div>\n            <div class="col-12 lg:col-4 xl:col-4">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round cursor-pointer"\n                (click)="goToServicos()">\n                <div class="flex justify-content-between mb-3">\n                  <div>\n                    <span class="block text-500 font-medium mb-3">Servi\xe7os</span>\n                    <div class="text-900 font-medium text-xl">Total (R$): {{ simplesDash.servico_prestado_valor |\n                      currency:\'BRL\':\'\' }}</div>\n                  </div>\n                  <div class="flex align-items-center justify-content-center bg-orange-100 border-round "\n                    style="width:2.5rem;height:2.5rem">\n                    <fa-icon class="text-orange-500 text-xl" style="font-size: 20px;"\n                      [icon]="[\'fas\', \'bell-concierge\']"></fa-icon>\n                  </div>\n                </div>\n                <span class="text-orange-500 font-medium">Quantidade: </span>\n                <span class="text-500">{{ simplesDash.servico_prestado_quantidade }}</span>\n              </div>\n            </div>\n            <div class="col-12 lg:col-4 xl:col-4">\n              <div class="surface-card shadow-2 p-3 border-1 border-50 border-round cursor-pointer"\n                (click)="gotToAssinaturas()">\n                <div class="flex justify-content-between mb-3">\n                  <div>\n                    <span class="block text-500 font-medium mb-3">Assinaturas</span>\n                    <div class="text-900 font-medium text-xl">Total (R$): {{ simplesDash.assinatura_venda_valor |\n                      currency:\'BRL\':\'\' }}</div>\n                  </div>\n                  <div class="flex align-items-center justify-content-center bg-green-100 border-round"\n                    style="width:2.5rem;height:2.5rem">\n                    <fa-icon class="text-green-500 text-xl" style="font-size: 20px;"\n                      [icon]="[\'fas\', \'file-contract\']"></fa-icon>\n                  </div>\n                </div>\n                <span class="text-green-500 font-medium">Quantidade: </span>\n                <span class="text-500">{{ simplesDash.assinatura_venda_quantidade }}</span>\n              </div>\n            </div>\n\n            <ng-container *ngIf="!selectedOption">\n              <div class="mx-auto mt-2">\n                <div class="border-2 border-dashed surface-border border-round surface-card \n              justify-content-center flex align-items-center text-xl" style="min-height: 20rem; width: 90vw;">\n                  Selecione uma op\xe7\xe3o acima\n                </div>\n              </div>\n            </ng-container>\n\n            <ng-container *ngIf="selectedOption==\'PRODUTO\'">\n              <app-cliente-dashboard-compras [cliente_id]="user.id"\n                [defaultDate]="selectedDate"></app-cliente-dashboard-compras>\n            </ng-container>\n\n            <ng-container *ngIf="selectedOption==\'SERVICO\'">\n              <app-cliente-dashboard-servicos [cliente_id]="user.id"\n                [defaultDate]="selectedDate"></app-cliente-dashboard-servicos>\n            </ng-container>\n\n            <ng-container *ngIf="selectedOption==\'ASSINATURA\'">\n              <app-cliente-dashboard-assinaturas [cliente_id]="user.id"\n                [defaultDate]="selectedDate"></app-cliente-dashboard-assinaturas>\n            </ng-container>\n\n          </ng-container>\n\n\n\n        </div>\n      </div>\n\n      <ng-container *ngIf="!hasAccount">\n        <div class="border-circle border-1 border-primary">\n          <app-attention-surface title="Aten\xe7\xe3o" subtitle="Vazio"\n            message="Sem registros de compras para o m\xeas selecionado"></app-attention-surface>\n        </div>\n      </ng-container>\n    </div>\n  </ng-container>\n</ion-content>\n\n<ion-footer>\n  <ion-toolbar>\n    <ion-button expand="full" color="danger" (click)="fechar()">Fechar</ion-button>\n  </ion-toolbar>\n</ion-footer>',styles:[""]})],F);var dt=t(33930);let Y=class{constructor(e,a,s,i){this.clientesService=e,this.modal=a,this.toastService=s,this.lojaService=i,this.sortUsertatus=Le.Mm,this.sortPessoaStatus=Le.hx,this.sortLojas=[],this.currentLojasPage=1,this.searchedLoja="",this.isLoaded=!1,this.searchedNome="",this.selectedPessoaStatus=void 0,this.selectedUsuarioStatus=void 0,this.currentPage=1,this.showStatusDialog=!1,this.editMenuItens=[{label:"Op\xe7\xf5es",items:[{label:"Atualizar",icon:"pi pi-user-edit",command:()=>this.detalharSimplificado(this.selectedUser)},{label:"Status",icon:"pi pi-exclamation-triangle",command:()=>this.detalharStatus(this.selectedUser)}]},{separator:!0,items:[{label:"Dashboard",icon:"pi pi-chart-line",command:()=>this.detalharHistorico(this.selectedUser)},{label:"Comunica\xe7\xe3o",icon:"pi pi-megaphone",command:()=>this.detalharComunicacao(this.selectedUser)}]}],this.updateStatusObj={status_user:void 0,status_pessoa:void 0},this.enderecoMode=dt.x.USER,this.contentError=new Ue.S,this.subscriptions=new M.w0}ngOnInit(){this.loadLoja(),this.loadClientes()}ngOnDestroy(){this.subscriptions.unsubscribe()}changeStatusUsuario({value:e}){this.selectedUsuarioStatus=e,this.loadClientes(1)}changeStatusPessoa({value:e}){this.selectedPessoaStatus=e,this.loadClientes(1)}changeLoja({value:e}){this.selectedLoja=e,this.loadClientes(1)}clearFilter(){this.loadClientes(1)}clearAllFilters(e,a,s){this.searchedNome=void 0,this.selectedLoja=void 0,this.selectedPessoaStatus=void 0,this.selectedUsuarioStatus=void 0,a.writeValue(null),s.writeValue(null),this.loadClientes(1)}loadLoja(){const e=this.lojaService.list({searchedLoja:this.searchedLoja,status_loja:Ne.eX.OPERANDO}).subscribe(a=>{this.lojas=a});this.subscriptions.add(e)}searchLoja({value:e}){this.searchedLoja=e,this.loadLoja()}clearLoja(e){e.value="",this.searchedLoja="",this.loadLoja()}loadClientes(e=1){const a=this.clientesService.list({searchedCliente:this.searchedNome,loja_id:this.selectedLoja,status_pessoa:this.selectedPessoaStatus,status_user:this.selectedUsuarioStatus},{order:J.L.DESC,page:e,take:5}).subscribe({next:s=>{this.contentError=new Ue.S,this.users=s,this.isLoaded=!0},error:s=>{this.contentError={code:s.status,hasError:!0}}});this.subscriptions.add(a)}updateStatus(){const{id:e}=this.selectedUser,{status_pessoa:a,status_user:s}=this.updateStatusObj,i=this.clientesService.update({status_pessoa:a,status_user:s},e).subscribe({next:o=>{this.toastService.presentToast({titulo:"Sucesso",detalhe:"Opera\xe7\xe3o bem sucedida!",duracao:c.m4.mediumDuration,gravidade:c.kl.SUCESSO}),this.showStatusDialog=!1,this.loadClientes(1)},error:o=>{this.showStatusDialog=!1}});this.subscriptions.add(i)}detalharSimplificado(e){this.showModal(L,{user:e})}detalharHistorico(e){this.showModal(F,{user:e})}detalharComunicacao(e){this.toastService.presentToast({titulo:"Indispon\xedvel",detalhe:"Opera\xe7\xe3o ainda n\xe3o est\xe1 dispon\xedvel",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO})}detalharStatus(e){const{status_pessoa:a,status_user:s}=e;this.updateStatusObj={status_pessoa:a,status_user:s},this.showStatusDialog=!0}detalharEndereco(e){e.endereco?this.showModal(Ye.F,{currentEndereco:e,enderecoMode:this.enderecoMode}):this.showModal(Je.A,{idOf:e.id,enderecoMode:this.enderecoMode,isModal:!0})}setUserImage(e){return e.avatar_url||"assets/imgs/outros/default-user.jpg"}createNewUser(){this.showModal(qe.r)}search(){this.loadClientes(1)}paginar(e){const{first:a,rows:s}=e,i=Number(Number(a)/Number(s)+1);i!=this.currentPage&&(this.currentPage=i,this.loadClientes(i))}detailLoja(e){e?this.showModal(_e.t,{loja:e}):this.toastService.presentToast({detalhe:"Usu\xe1rio sem loja alocada",titulo:"N\xe3o informado",duracao:c.m4.shortDuration,gravidade:c.kl.INFORMACAO})}showModal(e,a){var s=this;return(0,w.Z)(function*(){const i=yield s.modal.create({component:e,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:a});return i.onDidDismiss().then(o=>{const{data:v}=o;s.isLoaded=!1,s.loadClientes(),v&&s.toastService.presentToast({titulo:"Sucesso",detalhe:"Opera\xe7\xe3o bem sucedida!",duracao:c.m4.mediumDuration,gravidade:c.kl.SUCESSO})}),yield i.present()})()}};Y.ctorParameters=()=>[{type:Fe.Y},{type:u.IN},{type:j.D},{type:fe.W}],Y=(0,m.gn)([(0,d.wA2)({selector:"app-cliente-main",template:'<div class="card main-view h-full">\n\n  <ng-container *ngIf="isLoaded">\n    <p-dataView emptyMessage="Nada encontrado, experimente escolher outra carga" class="data-container" #dv\n      [lazy]="true" [value]="users.data" [paginator]="true" [rows]="users.meta.take"\n      [totalRecords]="users.meta.itemCount" [pageLinks]="users.meta.pageCount" (onLazyLoad)="paginar($event)"\n      filterBy="nome" layout="list">\n      <ng-template pTemplate="header">\n\n        <div class="flex grid formgrid p-fluid justify-content-between mb-2">\n          <div class="field  col-12 sm:col-6 xl:col-3">\n            <p-dropdown *ngIf="lojas" #dropdown_lojas id="loja_id" [options]="lojas.data" [filter]="true"\n              placeholder="Selecione" [virtualScroll]="true" [virtualScrollItemSize]="38" [lazy]="true" optionValue="id"\n              optionLabel="nome" filterBy="nome,codigo"\n              (onClear)="clearFilter($event)" (onChange)="changeLoja($event)" [showClear]="true"\n              styleClass="mb-2 md:mb-0 w-full">\n              <ng-template pTemplate="filter" let-options="options">\n                <div class="flex p-3">\n                  <div class="p-inputgroup" (click)="$event.stopPropagation()">\n                    <input #searchLojaInput type="text" pInputText placeholder="Procurar"\n                      (keyup.enter)="searchLoja(searchLojaInput)">\n                    <button pButton pRipple icon="pi pi-search" (click)="searchLoja(searchLojaInput)"></button>\n                    <button class="p-button-outlined" pButton pRipple icon="pi pi-times"\n                      (click)="clearLoja(searchLojaInput)"></button>\n                  </div>\n                </div>\n              </ng-template>\n              <ng-template pTemplate="loader" let-options="options">\n                <div class="flex align-items-center py-2 px-3" style="height: 38px">\n                  <p-skeleton width="50%" height="1rem"></p-skeleton>\n                </div>\n              </ng-template>\n              <ng-template let-loja pTemplate="item">\n                <div>\n                  <div>[{{ loja.codigo }}] {{ loja.nome}}</div>\n                </div>\n              </ng-template>\n              <ng-template let-loja pTemplate="selectedItem">\n                <div>[{{ loja.codigo }}] {{ loja.nome}}</div>\n              </ng-template>\n            </p-dropdown>\n          </div>\n\n          <div class="field mb-2 col-12 sm:col-6 xl:col-3">\n            <p-dropdown #dropdown_filtro [options]="sortUsertatus" placeholder="Status Usu\xe1rio"\n              (onChange)="changeStatusUsuario($event)" (onClear)="clearFilter($event)" [showClear]="true"\n              styleClass="mb-2 md:mb-0 w-full"></p-dropdown>\n          </div>\n\n          <div class="field mb-2 col-12 sm:col-6 xl:col-3">\n            <p-dropdown #dropdown_filtro [options]="sortPessoaStatus" placeholder="Status Pessoa"\n              (onChange)="changeStatusPessoa($event)" (onClear)="clearFilter($event)" [showClear]="true"\n              styleClass="mb-2 md:mb-0 w-full"></p-dropdown>\n          </div>\n        </div>\n\n        <div class="flex grid formgrid p-fluid justify-content-between mb-2">\n          <div class="field col-12 sm:col-6 xl:col-3">\n            <button pButton pRipple class="sm:w-auto w-full p-button-outlined" icon="pi pi-times" label="Limpar filtros"\n              (click)="clearAllFilters($event, dropdown_lojas, dropdown_filtro)">\n            </button>\n          </div>\n          <div class="field col-12 sm:col-6 xl:col-3 text-right">\n            <button pButton pRipple class="sm:w-auto w-full " icon="pi pi-user-plus" label="Novo cadastro"\n              (click)="createNewUser()">\n            </button>\n          </div>\n        </div>\n\n        <div class="flex flex-column md:flex-row md:justify-content-center">\n          <span class="p-inputgroup mb-2 md:mb-0 mt-2 max-w-30rem\t">\n            <input class="w-full" type="search" pInputText [(ngModel)]="searchedNome"\n              [ngModelOptions]="{standalone: true}" placeholder="CPF, Email ou Nome" (keyup.enter)="search()">\n            <button type="button" pButton pRipple class="pi pi-search cursor-pointer p-button-outlined"\n              (click)="search()"></button>\n            <button type="button" pButton pRipple class="pi pi-times cursor-pointer p-button-outlined p-button-danger"\n              (click)="searchedNome = \'\'; search();"></button>\n          </span>\n        </div>\n\n      </ng-template>\n\n      <ng-template let-user pTemplate="listItem">\n        <div *ngIf="isLoaded" #templateGrid class="col-12">\n          <div class="data-list-item">\n            <div class="crop mb-2 md:mb-0 ">\n              <img class="border-circle border-2 border-primary" [src]="setUserImage(user)" [alt]="user.name" />\n            </div>\n            <div class="data-list-detail">\n              <div class="data-name">{{ user.nome }}</div>\n              <div class="data-description mt-2">CPF: {{ user.cpf | cpfMask }}</div>\n              <div class="data-description mt-1">Situa\xe7\xe3o: {{ user.status_pessoa }}</div>\n              <div class="data-description mt-1">Acesso: {{ user.status_user }}</div>\n\n              <div class="data-description mt-2">E-mail: {{ user.email }}</div>\n              <div *ngIf="user.email_alternativo" class="data-description mt-1">E-mail (alternativo): {{\n                user.email_alternativo }}</div>\n              <div class="data-description mt-1">Celular: {{ user.tel1 | phoneMask }}</div>\n              <div *ngIf="user.tel2" class="data-description mt-1">Celular (alternativo): {{ user.tel2 | phoneMask }}\n              </div>\n\n              <div class="data-description mt-2 ">\n                <span class="cursor-pointer hover:text-primary" (click)="detailLoja(user.loja)">\n                  Loja:\n                  {{ user.loja?.nome || \'N\xe3o informado\' }}\n                  <i class="pi pi-external-link text-xs ml-1"></i>\n                </span>\n              </div>\n\n              <div class="mt-3">\n                <i class="pi pi-sitemap data-category-icon "></i>\n                <span class="data-category">Acesso: {{user.perfil?.nome || "Sem\n                  Perfil"}}</span>\n              </div>\n            </div>\n            <div class="data-list-action">\n              <button type="button" pButton icon="pi pi-cog" label="Op\xe7\xf5es"\n                (click)="selectedUser = user; editMenu.toggle($event)"></button>\n              <p-menu #editMenu appendTo="body" [popup]="true" [model]="editMenuItens"></p-menu>\n\n              <button pButton type="button" class="p-button-outlined" icon="pi pi-map" label="Endere\xe7o"\n                (click)="detalharEndereco(user)">\n              </button>\n            </div>\n          </div>\n        </div>\n      </ng-template>\n    </p-dataView>\n  </ng-container>\n\n  <ng-container *ngIf="contentError.hasError">\n    <app-content-error [erroCode]="contentError.code"></app-content-error>\n  </ng-container>\n\n\n  <p-dialog *ngIf="showStatusDialog" [(visible)]="showStatusDialog" [resizable]="false" [draggable]="false"\n    [modal]="true" [breakpoints]="{\'960px\': \'75vw\', \'640px\': \'100vw\'}" [style]="{width: \'40vw\', height: \'80%\'}">\n    <ng-template pTemplate="header">\n      <div class="flex align-items-center">\n        <div class="text-900 font-medium mb-3 text-xl">Alterando status</div>\n      </div>\n    </ng-template>\n    <div class="surface-card border-round shadow-2 p-4">\n      <p class="mt-0 mb-4 p-0 line-height-3">Acesso ao sistema: </p>\n      <p-dropdown [options]="sortUsertatus" emptyMessage="Nada dispon\xedvel" placeholder="Selecione"\n        [(ngModel)]="updateStatusObj.status_user" [ngModelOptions]="{standalone: true}"\n        styleClass="mb-2 md:mb-0 w-full">\n      </p-dropdown>\n    </div>\n\n    <div class="surface-card border-round shadow-2 p-4 mt-2">\n      <p class="mt-0 mb-4 p-0 line-height-3">Situa\xe7\xe3o na corpora\xe7\xe3o: </p>\n      <p-dropdown [options]="sortPessoaStatus" emptyMessage="Nada dispon\xedvel" placeholder="Selecione"\n        [(ngModel)]="updateStatusObj.status_pessoa" [ngModelOptions]="{standalone: true}"\n        styleClass="mb-2 md:mb-0 w-full">\n      </p-dropdown>\n    </div>\n    <div class="flex justify-content-end mt-3 grid">\n      <div class="surface-border border-top-1 opacity-50 mb-1 col-12"></div>\n      <button class="" pButton pRipple label="Atualizar" (click)="updateStatus()"></button>\n    </div>\n  </p-dialog>\n</div>',styles:[""]})],Y);let ae=class{};ae=(0,m.gn)([(0,d.LVF)({declarations:[Y],imports:[g.ez,l.u5,l.UX,u.Pc,le.FI,Ae.QK,T.j,pe.A,B.T,G.l,ve.x,Pe.F,$.$9,Me.q,ue.U,me.cc,de.Q,Te.ON,N.kW,ce.LU,T.j,R.S,P.hJ,U.O,he.D,Xe.f,f.o,We.a,we.X,je.R,Ke.U,Ze.S],exports:[Y]})],ae);var $e=t(1236),ze=t(23520),ke=t(17913),He=t(61989),Ve=t(25047),ct=t(3631),z=t(70585),pt=t(99983);let se=class{};se=(0,m.gn)([(0,d.LVF)({declarations:[L],imports:[g.ez,l.u5,l.UX,u.Pc,le.FI,Ae.QK,T.j,ze.zz,ke.Iu,pe.A,pt.O,He.nD,B.T,Ve.L$,ct.WN,G.l,ve.x,Pe.F,$.$9,Me.q,ue.U,me.cc,de.Q,z._8,Te.ON,N.kW,$e.q,ce.LU,T.j,R.S,P.hJ,U.O,he.D,f.o,we.X,je.R],exports:[L]})],se);var ne=t(52054),ut=t(83111),mt=t(12453),ht=t(24382),_=t(91670),vt=t(73425),ft=t(28396),gt=t(78177),bt=t(91746);var be=t(32470),Dt=t(71644),D=t(75828),Ct=t(82455);let O=class{constructor(e,a,s,i,o,v){this.pedidoService=e,this.modalCliHistCompras=a,this.toastService=s,this.router=i,this.lojaService=o,this.userService=v,this.currentTab="listagem",this.searchedPedido="",this.sortLojas=[],this.sortStatus=[],this.sortLocais=[],this.currentPage=1,this.pageOrder=J.L.DESC,this.currentTake=5,this.min_total=0,this.max_total=0,this.selectedPedidos=[],this.subscriptions=new M.w0}ngOnInit(){this.sortStatus=[...D.SX],this.sortLocais=[...D.YU],this.cols=[{field:"id",header:"ID"},{field:"loja.nome",header:"Loja"},{field:"cliente.nome",header:"Cliente"},{field:"vendedor.nome",header:"Vendedor"},{field:"total_pedido",header:"Total do Pedido"},{field:"status_pedido",header:"Status"},{field:"from_pdv",header:"Local"},{field:"created_at",header:"Data de Cria\xe7\xe3o"}],this.exportColumns=this.cols.map(e=>({title:e.header,dataKey:e.field})),this.loadPedidos()}ngOnDestroy(){this.subscriptions.unsubscribe()}loadPedidos(e=1,a){const s=this.pedidoService.list({searchedPedido:this.searchedPedido,searchedLoja:this.searchedLoja,status_pedido:this.selectedStatus,local:this.selectedLocal,searchedCliente:this.searchedCliente,searchedVendedor:this.searchedColaborador,min_total:Number(this.min_total),max_total:Number(this.max_total),created_at:this.selectedDate,cliente_id:this.cliente_id},{order:this.pageOrder,page:e,take:this.currentTake}).subscribe({next:i=>{this.pedidos=i,this.selectedCliente=i.data[0].cliente},error:()=>{},complete:()=>{a&&(a.paginator=!0)}});this.subscriptions.add(s)}paginar(e,a){a.paginator=!1;const{first:s,rows:i,sortOrder:o}=e,v=Number(Number(s)/Number(i)+1);this.doFilter(e),this.currentPage=v,this.currentTake=i,this.pageOrder=o&&1==o?J.L.DESC:J.L.ASC,this.loadPedidos(v,a)}doFilter(e){if(!e||!e.filters||!e.filters.id)return;const{id:a,cliente:s,vendedor:i,created_at:o,loja:v,status:I,local:A}=e.filters;this.min_total>this.max_total&&(this.max_total=void 0),a[0].value?this.searchedPedido=a[0].value:this.searchedPedido=void 0,i[0].value?this.searchedColaborador=i[0].value:this.searchedColaborador=void 0,I[0].value?this.selectedStatus=I[0].value:this.selectedStatus=void 0,A[0].value?this.selectedLocal=A[0].value:this.selectedLocal=void 0,o[0].value?this.selectedDate=o[0].value:this.selectedDate=void 0,v[0].value?this.searchedLoja=v[0].value:this.searchedLoja=void 0}clearTotal(){this.min_total=void 0,this.max_total=void 0,this.loadPedidos(1)}exportPdf(){const e=`Pedidos - ${(new Date).toLocaleDateString()}`,a=this.cols.map(i=>i.header),s=this.convertPedidoData().map(Object.values);be.P.exportPdf(e,a,s)}exportExcel(){const e=`Pedidos - ${(new Date).toLocaleDateString()}`;be.P.exportExcel(e,this.convertPedidoData())}exportCsv(){const e=`Pedidos - ${(new Date).toLocaleDateString()}`;be.P.exportCSV(e,this.convertPedidoData())}doCancelamento(e){}detail(e){this.showModal(Ct.z,{pedido:e})}openCliente(e){}convertPedidoData(){return this.pedidos.data.map(a=>({id:a.id,loja:a.loja.nome,cliente:a.cliente.nome,vendedor:a.vendedor.nome,total_pedido:a.total_pedido,status:a.status_pedido,local:a.from_pdv?D.Gz.PDV:D.Gz.E_COMMERCE,data_criacao:new Date(a.created_at).toLocaleDateString()}))}fechar(e=!1){this.modalCliHistCompras.dismiss(e)}showModal(e,a){var s=this;return(0,w.Z)(function*(){const i=yield s.modalCliHistCompras.create({component:e,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:a});return i.onDidDismiss().then(o=>{const{data:v,role:I}=o;v&&(s.loadPedidos(s.currentPage),s.toastService.presentToast({detalhe:"Opera\xe7\xe3o bem sucedida!",titulo:"Sucesso!",duracao:c.m4.mediumDuration,gravidade:c.kl.SUCESSO}))}),yield i.present()})()}};O.ctorParameters=()=>[{type:Dt.$},{type:u.IN},{type:j.D},{type:y.F0},{type:fe.W},{type:Re.K}],O.propDecorators={cliente_id:[{type:d.IIB}]},O=(0,m.gn)([(0,d.wA2)({selector:"app-cliente-historico-compras",template:'<ion-content appScrollTheme>\n  <div style="max-width: 98%; margin: auto">\n    <p-table *ngIf="pedidos" #dt styleClass="mt-3 py-3 mb-1" [(selection)]="selectedPedidos" dataKey="id"\n      [rowHover]="true" [showCurrentPageReport]="true" [filterDelay]="2"\n      [rowsPerPageOptions]="[5,10,25,50,100,250,500,1000]"\n      [globalFilterFields]="[\'nome\',\'cliente.nome\', \'vendedor.nome\', \'status\']"\n      currentPageReportTemplate="Mostrando {first} at\xe9 {last} de {totalRecords} entradas" [lazy]="true"\n      [value]="pedidos.data" [paginator]="true" [rows]="pedidos.meta.take" [totalRecords]="pedidos.meta.itemCount"\n      [pageLinks]="pedidos.meta.pageCount" (onLazyLoad)="paginar($event, dt)" responsiveLayout="scroll">\n      <ng-template pTemplate="caption">\n        <div class="grid flex">\n\n          <div class="table-header text-primary col-6">\n            Lista de pedidos do cliente:\n            <span class="text-900"> {{ selectedCliente?.nome }}</span>\n          </div>\n\n          <div class="col-6 justify-content-end text-right">\n            <button type="button" pButton pRipple icon="pi pi-file-o" (click)="exportCsv()" class="p-button-help mr-2"\n              pTooltip="CSV" tooltipPosition="bottom"></button>\n\n            <button type="button" pButton pRipple icon="pi pi-file-excel" (click)="exportExcel()"\n              class="p-button-success mr-2" pTooltip="XLS" tooltipPosition="bottom"></button>\n\n            <button type="button" pButton pRipple icon="pi pi-file-pdf" (click)="exportPdf()"\n              class="p-button-danger mr-2" pTooltip="PDF" tooltipPosition="bottom"></button>\n          </div>\n\n        </div>\n      </ng-template>\n      <ng-template pTemplate="header">\n        <tr>\n\n          <th class="text-center">\n            <div class="flex justify-content-between align-items-center">\n              ID\n              <p-columnFilter [showAddButton]="false" [showMatchModes]="false" [showOperator]="false" type="text"\n                field="id" [pSortableColumnDisabled]="true" class="ml-auto" display="menu"></p-columnFilter>\n            </div>\n          </th>\n\n          <th class="text-center">\n            <div class="flex justify-content-between align-items-center">\n              Loja\n              <p-columnFilter [showAddButton]="false" [showMatchModes]="false" [showOperator]="false" type="text"\n                field="loja" display="menu" class="ml-auto"></p-columnFilter>\n            </div>\n          </th>\n\n          <th class="text-center">\n            <div class="flex justify-content-between align-items-center">\n              Cliente\n              \x3c!--\n            <p-columnFilter [showAddButton]="false" [showMatchModes]="false" [showOperator]="false" type="text"\n              field="cliente" display="menu" class="ml-auto"></p-columnFilter>\n              --\x3e\n            </div>\n          </th>\n\n          <th class="text-center">\n            <div class="flex justify-content-between align-items-center">\n              Vendedor\n              <p-columnFilter [showAddButton]="false" [showMatchModes]="false" [showOperator]="false" type="text"\n                field="vendedor" display="menu" class="ml-auto"></p-columnFilter>\n            </div>\n          </th>\n\n          <th class="text-center">\n            <div class="flex justify-content-between align-items-center">\n              Total do pedido\n              <p-columnFilter [showAddButton]="false" [showMatchModes]="false" [showOperator]="false" type="numeric"\n                field="total_pedido" display="menu" currency="BRL" class="ml-auto" [showClearButton]="false">\n                <ng-template pTemplate="filter" let-value let-filter="filterCallback">\n                  <div class="grid  justify-content-between">\n                    <div class="field col-6 text-center">\n                      <label for="minmax-buttons">M\xednimo (R$)</label>\n                      <p-inputNumber mode="decimal" [showButtons]="true" buttonLayout="vertical" spinnerMode="vertical"\n                        inputId="vertical" decrementButtonClass="button-secondary"\n                        incrementButtonClass="button-secondary" incrementButtonIcon="pi pi-plus"\n                        decrementButtonIcon="pi pi-minus" [min]="0" [(ngModel)]="min_total" [minFractionDigits]="2"\n                        [maxFractionDigits]="2">\n                      </p-inputNumber>\n                    </div>\n\n                    <div class="field  col-6 text-center">\n                      <label for="minmax-buttons">Max (R$)</label>\n                      <p-inputNumber mode="decimal" [showButtons]="true" buttonLayout="vertical" spinnerMode="vertical"\n                        inputId="vertical" decrementButtonClass="button-secondary"\n                        incrementButtonClass="button-secondary" incrementButtonIcon="pi pi-plus"\n                        decrementButtonIcon="pi pi-minus" [min]="min_total" [(ngModel)]="max_total"\n                        [minFractionDigits]="2" [maxFractionDigits]="2">\n                      </p-inputNumber>\n                    </div>\n                  </div>\n                  <div>\n                    <button pButton type="button" class="button-primary p-button-outlined w-full" label="Limpar"\n                      (click)="clearTotal()"></button>\n                  </div>\n                </ng-template>\n              </p-columnFilter>\n            </div>\n          </th>\n\n          <th class="text-center">\n            <div class="flex justify-content-between align-items-center">\n              Status\n              <p-columnFilter [showAddButton]="false" [showMatchModes]="false" [showOperator]="false" field="status"\n                matchMode="equals" display="menu" class="ml-auto">\n                <ng-template pTemplate="filter" let-value let-filter="filterCallback">\n                  <p-dropdown [ngModel]="value" [options]="sortStatus" (onChange)="filter($event.value)"\n                    placeholder="Status">\n                    <ng-template let-option pTemplate="item">\n                      <span class="font-light py-1 px-3 text-blue-500 hover:bg-blue-100" style="border-radius: 30px;"\n                        [ngClass]="{\n                        \'PENDENTE_ESTOQUE\' : \'text-pink-500 hover:bg-pink-100\', \n                        \'CANCELADO\' : \'text-pink-500 hover:bg-pink-100\', \n                        \n                        \'PENDENTE_PAGAMENTO\' : \'text-yellow-500 hover:bg-yellow-100\', \n                        \'CANCELAMENTO_SOLICITADO\' : \'text-yellow-500 hover:bg-yellow-100\', \n                \n                        \'FINALIZADO\' : \'text-green-500 hover:bg-green-100\'\n                      }[option.value]">{{option.label}}</span>\n                    </ng-template>\n                  </p-dropdown>\n                </ng-template>\n              </p-columnFilter>\n            </div>\n          </th>\n\n          <th class="text-center">\n            <div class="flex justify-content-between align-items-center">\n              Local\n              <p-columnFilter field="local" matchMode="between" display="menu" [showMatchModes]="false"\n                [showOperator]="false" [showAddButton]="false" class="ml-auto">\n                <ng-template pTemplate="filter" let-value let-filter="filterCallback">\n                  <p-dropdown [ngModel]="value" [options]="sortLocais" (onChange)="filter($event.value)"\n                    placeholder="Local">\n                    <ng-template let-option pTemplate="item">\n                      <div class="mb-2">\n                        <fa-icon class="text-primary text-xs "\n                          [icon]="option.label == \'PDV\'? [\'fas\', \'shop\']: [\'fas\', \'at\']"></fa-icon>\n                        <span class="font-light px-2 " style="border-radius: 30px;">{{option.label}}</span>\n                      </div>\n                    </ng-template>\n                  </p-dropdown>\n                </ng-template>\n              </p-columnFilter>\n            </div>\n          </th>\n\n          <th class="text-center" pSortableColumn="created_at">\n            <div class="flex justify-content-between align-items-center text-center">\n              Data de Cria\xe7\xe3o\n              <p-sortIcon field="created_at"></p-sortIcon>\n              <p-columnFilter type="date" field="created_at" display="menu" class="ml-auto" matchMode="between"\n                display="menu" [showMatchModes]="false" [showOperator]="false" [showAddButton]="false"></p-columnFilter>\n            </div>\n          </th>\n          <th style="width: 8rem"></th>\n        </tr>\n      </ng-template>\n      <ng-template pTemplate="body" let-data>\n        <tr>\n          <td class="text-center">\n            <span class="p-column-title">ID</span>\n            {{data.id}}\n          </td>\n\n          <td class="text-center">\n            <span class="p-column-title">Loja</span>\n            <span class="image-text cursor-pointer">{{data.loja.nome}}</span>\n          </td>\n\n          <td class="text-center">\n            <span class="p-column-title">Cliente</span>\n            <div class="cursor-pointer" (click)="openCliente(data.cliente.id)">\n              <img *ngIf="data.cliente" [src]="data.cliente?.avatar_url || \'assets/imgs/outros/default-user.jpg\'"\n                width="32" height="32" class="mr-1 border-circle border-2 border-primary"\n                style="vertical-align: middle" />\n              <br><br>\n              <span class="image-text">{{data.cliente.nome}}</span>\n            </div>\n          </td>\n\n          <td class="text-center">\n            <span class="p-column-title">Vendedor</span>\n            <div class="cursor-pointer" (click)="openColaborador(data.vendedor.id)">\n              <img *ngIf="data.vendedor" [src]="data.vendedor?.avatar_url || \'assets/imgs/outros/default-user.jpg\'"\n                width="32" height="32" class="mr-1 border-circle border-2 border-primary"\n                style="vertical-align: middle" />\n              <br><br>\n              <span class="image-text">{{data.vendedor.nome}}</span>\n            </div>\n          </td>\n\n          <td class="text-center">\n            {{data.total_pedido | currency:\'BRL\':\'R$\'}}\n          </td>\n\n          <td class="text-center">\n            <span class="p-column-title">Status</span>\n            <span class="font-light py-1 px-3 text-blue-500 bg-blue-100" style="border-radius: 30px;" [ngClass]="{\n            \'PENDENTE_ESTOQUE\' : \'text-pink-500 bg-pink-100\', \n            \'CANCELADO\' : \'text-pink-500 bg-pink-100\', \n            \n            \'PENDENTE_PAGAMENTO\' : \'text-yellow-500 bg-yellow-100\', \n            \'CANCELAMENTO_SOLICITADO\' : \'text-yellow-500 bg-yellow-100\', \n    \n            \'FINALIZADO\' : \'text-green-500 bg-green-100\'\n          }[data.status_pedido]">{{data.status_pedido}}\n            </span>\n          </td>\n\n          <td class="text-center">\n            <span class="p-column-title">Local</span>\n            <div class="text-center" *ngIf="data.from_pdv">\n              <fa-icon class="text-primary text-xs mb-1" [icon]="[\'fas\', \'shop\']"></fa-icon>\n              <br><br>\n              <span>PDV</span>\n            </div>\n            <div class="text-center" *ngIf="!data.from_pdv">\n              <fa-icon class="text-primary text-xs mb-1" [icon]="[\'fas\', \'at\']"></fa-icon>\n              <br><br>\n              <span>E-Commerce</span>\n            </div>\n          </td>\n\n          <td class="text-center">\n            <span class="p-column-title">Data de cria\xe7\xe3o</span>\n            {{data.created_at | date: \'dd/MM/yyyy\'}}\n          </td>\n          <td class="text-center">\n            <button pButton type="button" class="button-primary p-button-outlined" icon="pi pi-external-link"\n              (click)="detail(data)"></button>\n          </td>\n        </tr>\n      </ng-template>\n\n      <ng-template pTemplate="emptymessage">\n        <tr>\n          <td colspan="12">\n            <div class="surface-ground px-4 py-4 md:px-6 lg:px-8 h-full">\n              <div\n                style="background: radial-gradient(50% 109137.91% at 50% 50%, rgba(233, 203, 30, 0.1) 0%, rgba(254, 253, 244, 0) 100%);"\n                class="text-center">\n                <span class="bg-surface-50 text-yellow-500 font-bold text-2xl inline-block px-3">Aten\xe7\xe3o</span>\n              </div>\n              <div class="mt-6 mb-5 font-bold text-6xl text-900 text-center">Nenhum pedido encontrado</div>\n              <p class="text-700 text-3xl mt-0 mb-6 text-center">Experimente trocar os filtros.</p>\n\n            </div>\n          </td>\n        </tr>\n      </ng-template>\n    </p-table>\n  </div>\n</ion-content>\n\n<ion-footer>\n  <ion-toolbar>\n    <ion-button expand="full" color="danger" (click)="fechar()">Fechar</ion-button>\n  </ion-toolbar>\n</ion-footer>',styles:[""]})],O);var xe=t(68639);var k=t(3051),ye=t(67935),De=t(54692),ie=t(80529),H=t(99038);let V=class{constructor(e){this.http=e}getPedidoDashByCliente({cliente_id:e,data_inicial:a=new Date((new Date).getTime()-2592e6),data_final:s=new Date(H.zr),status:i=D.$x.FINALIZADO}){const o=(new ie.LE).set("cliente_id",e).set("data_inicial",a.toDateString()).set("data_final",s.toDateString()).set("status",i);return this.http.get(`${H.Hz.baseURL}/financeiro/dashboard-clientes/pedidos`,{responseType:"json",params:o})}getPrestacaoServicoDashByCliente({cliente_id:e,data_inicial:a=new Date((new Date).getTime()-2592e6),data_final:s=new Date(H.zr),status:i=De.vx.FINALIZADO}){const o=(new ie.LE).set("cliente_id",e).set("data_inicial",a.toDateString()).set("data_final",s.toDateString()).set("status",i);return this.http.get(`${H.Hz.baseURL}/financeiro/dashboard-clientes/prestacao-servicos`,{responseType:"json",params:o})}getAssinaturasDashByCliente({cliente_id:e,data_inicial:a=new Date((new Date).getTime()-2592e6),data_final:s=new Date(H.zr),status:i=ye.n.ATIVO}){const o=(new ie.LE).set("cliente_id",e).set("data_inicial",a.toDateString()).set("data_final",s.toDateString()).set("status",i);return this.http.get(`${H.Hz.baseURL}/financeiro/dashboard-clientes/assinaturas`,{responseType:"json",params:o})}};V.ctorParameters=()=>[{type:ie.eN}],V=(0,m.gn)([(0,d.GSi)({providedIn:"root"})],V);let X=class{constructor(e,a,s,i,o,v){this.dashboardClientesService=e,this.toastService=a,this.dashboardUtilsService=s,this.preferencesService=i,this.modalDashCtrl=o,this.formBuilder=v,this.items=[{label:"Op\xe7\xf5es",items:[{label:"Filtro",icon:"pi pi-fw pi-filter",command:()=>this.openFiltro()},{label:"Hist\xf3rico",icon:"pi pi-fw pi-money-bill",command:()=>this.openHistorico()}]},{separator:!0},{label:"Exportar como",items:[{label:"PDF",icon:"pi pi-fw pi-file-pdf",command:()=>{this.dashboard?this.dashboard.exportPDF():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}},{label:"CSV",icon:"pi pi-fw pi-file",command:()=>{this.dashboard?this.dashboard.exportCSV():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}},{label:"XLSX",icon:"pi pi-fw pi-file-excel",command:()=>{this.dashboard?this.dashboard.exportXLSX():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}}]}],this.showFilter=!1,this.statusPedido=D.SX,this.mesPassado=new Date((new Date).getTime()-2592e6),this.subscriptions=new M.w0}ngOnInit(){this.defaultDate||(this.defaultDate=new Date);const{data_inicial:e,data_final:a}=q.E.calcularIntervaloDoMes(this.defaultDate);this.loadDash({cliente_id:void 0,data_inicial:e,data_final:a,status:D.$x.FINALIZADO}),this.form=this.formBuilder.group({dataInicial:[e,[l.kI.required]],dataFinal:[a,[l.kI.required]],status:[D.$x.FINALIZADO,[l.kI.required]]})}ngOnDestroy(){this.subscriptions.unsubscribe()}loadDash(e){const a=e?.data_inicial||this.mesPassado,s=e?.data_final||new Date,i=this.dashboardClientesService.getPedidoDashByCliente({cliente_id:this.cliente_id,data_inicial:a,data_final:s,status:e?.status||D.$x.FINALIZADO}).subscribe({next:o=>{o&&o.length<0?this.toastService.presentToast({titulo:"Sem dados para o filtro de datas",detalhe:`De ${(0,k.Z)(a,"dd/MM/yy")}, at\xe9 ${(0,k.Z)(s,"dd/MM/yy")}`,duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO}):(this.dashboardData=o,this.dashboard=this.dashboardUtilsService.mountClienteDash(o))}});this.subscriptions.add(i)}getTheme(){const{theme:e,dashboard:a}=this.preferencesService.getDashboardTheme(this.dashboard);return this.dashboard=a,e}openHistorico(){this.showModal(O,{cliente_id:this.cliente_id})}openFiltro(){this.showFilter=!0}doFilter(){const e=new Date(this.form.get("dataInicial").value),a=new Date(this.form.get("dataFinal").value),s=this.form.get("status").value;this.loadDash({data_final:a,data_inicial:e,status:s,cliente_id:void 0}),this.showFilter=!1}disableFilterBtn(){return!this.form.valid}isInputError(e){return!(this.form.controls[e].untouched||!this.form.controls[e].errors)}showModal(e,a){var s=this;return(0,w.Z)(function*(){const i=yield s.modalDashCtrl.create({component:e,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:a});return i.onDidDismiss().then(o=>{const{data:v}=o;v&&s.toastService.presentToast({titulo:"Sucesso",detalhe:"Opera\xe7\xe3o bem sucedida!",duracao:c.m4.mediumDuration,gravidade:c.kl.SUCESSO})}),yield i.present()})()}};X.ctorParameters=()=>[{type:V},{type:j.D},{type:te.z},{type:ee.y},{type:u.IN},{type:l.QS}],X.propDecorators={cliente_id:[{type:d.IIB}],defaultDate:[{type:d.IIB}]},X=(0,m.gn)([(0,d.wA2)({selector:"app-cliente-dashboard-compras",template:'<ng-container *ngIf="dashboardData">\n  <div class="surface-card shadow-2 border-round p-4 mx-auto" style="width: 95vw;">\n    <div class="flex align-items-center justify-content-between mb-3">\n      <div class="text-900 font-medium text-xl">Compras</div>\n      <div>\n        <button pButton pRipple icon="pi pi-ellipsis-v" class="p-button-text p-button-plain p-button-rounded"\n          (click)="dashMenu.toggle($event)"></button>\n        <p-menu #dashMenu [popup]="true" [model]="items" appendTo="body"></p-menu>\n      </div>\n    </div>\n    <div #clienteDash class="flex justify-content-center mb-3">\n      <div class="w-full" echarts [options]="dashboard" [theme]="getTheme()"\n        style="width: 400px; height: 400px; box-shadow: white">\n      </div>\n    </div>\n  </div>\n</ng-container>\n\n\n<p-dialog [(visible)]="showFilter" [resizable]="false" [draggable]="false" [modal]="true"\n  [breakpoints]="{\'960px\': \'75vw\', \'640px\': \'100vw\'}" [style]="{width: \'60vw\', height: \'80%\'}">\n  <ng-template pTemplate="header">\n    <div class="flex align-items-center">\n      <div class="text-900 font-medium mb-3 text-xl">Filtro</div>\n    </div>\n  </ng-template>\n  <div class="surface-card border-round shadow-2 p-4">\n    <form [formGroup]="form" (ngSubmit)="$event.preventDefault()">\n      <div class="grid formgrid p-fluid">\n        <div class="field mb-4 col-12 ">\n          <label for="dataInicial" class="font-medium text-900">Data Inicial</label>\n          <p-calendar id="dataInicial" formControlName="dataInicial" inputId="dateformat" dateFormat="dd/mm/yy"\n            [touchUI]="true"></p-calendar>\n          <div class="flex mt-1 justify-content-end">\n            <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'dataInicial\')"></p-message>\n          </div>\n        </div>\n        <div class="field mb-4 col-12 ">\n          <label for="dataFinal" class="font-medium text-900">Data Final</label>\n          <p-calendar id="dataFinal" formControlName="dataFinal" inputId="dateformat" dateFormat="dd/mm/yy"\n            [touchUI]="true"></p-calendar>\n          <div class="flex mt-1 justify-content-end">\n            <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'dataFinal\')"></p-message>\n          </div>\n        </div>\n        <div class="surface-border border-top-1 opacity-50 mb-4 col-12"></div>\n        <div class="field mb-4 col-12 ">\n          <p-dropdown [options]="statusPedido" placeholder="Status do Pedido" formControlName="status"></p-dropdown>\n        </div>\n      </div>\n    </form>\n  </div>\n  <ng-template pTemplate="footer">\n    <button pButton pRipple label="Filtrar" (click)="doFilter()" [disabled]="disableFilterBtn()"></button>\n  </ng-template>\n</p-dialog>',styles:[""]})],X);let oe=class{};oe=(0,m.gn)([(0,d.LVF)({declarations:[X],imports:[g.ez,l.u5,l.UX,u.Pc,ne.Ns.forRoot({echarts:()=>t.e(7386).then(t.bind(t,77386))}),T.j,xe.TX,G.l,P.hJ,B.T,$.$9,R.S,z._8,U.O,N.kW,_.A,f.o],exports:[X]})],oe);let Ce=class{};Ce=(0,m.gn)([(0,d.LVF)({declarations:[O],imports:[g.ez,l.u5,l.UX,u.Pc,p.uH,le.FI,de.Q,T.j,P.hJ,N.kW,ce.LU,U.O,ze.zz,z._8,Ve.L$,me.cc,$e.q,vt.gz,ke.Iu,ft.U$,he.D,R.S,gt.JH,pe.A,He.nD,_.A,bt.J,f.o,oe],exports:[O]})],Ce);let W=class{constructor(e,a,s,i,o,v){this.dashboardClientesService=e,this.toastService=a,this.dashboardUtilsService=s,this.preferencesService=i,this.modalDashCtrl=o,this.formBuilder=v,this.items=[{label:"Op\xe7\xf5es",items:[{label:"Filtro",icon:"pi pi-fw pi-filter",command:()=>this.openFiltro()},{label:"Hist\xf3rico",icon:"pi pi-fw pi-money-bill",command:()=>this.openHistorico()}]},{separator:!0},{label:"Exportar como",items:[{label:"PDF",icon:"pi pi-fw pi-file-pdf",command:()=>{this.dashboard?this.dashboard.exportPDF():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}},{label:"CSV",icon:"pi pi-fw pi-file",command:()=>{this.dashboard?this.dashboard.exportCSV():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}},{label:"XLSX",icon:"pi pi-fw pi-file-excel",command:()=>{this.dashboard?this.dashboard.exportXLSX():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}}]}],this.showFilter=!1,this.statusPedido=D.SX,this.mesPassado=new Date((new Date).getTime()-2592e6),this.subscriptions=new M.w0}ngOnInit(){this.defaultDate||(this.defaultDate=new Date);const{data_inicial:e,data_final:a}=q.E.calcularIntervaloDoMes(this.defaultDate);this.loadDash({cliente_id:void 0,data_inicial:e,data_final:a,status:De.vx.FINALIZADO}),this.form=this.formBuilder.group({dataInicial:[e,[l.kI.required]],dataFinal:[a,[l.kI.required]],status:[D.$x.FINALIZADO,[l.kI.required]]})}ngOnDestroy(){this.subscriptions.unsubscribe()}loadDash(e){const a=e?.data_inicial||this.mesPassado,s=e?.data_final||new Date,i=this.dashboardClientesService.getPrestacaoServicoDashByCliente({cliente_id:this.cliente_id,data_inicial:a,data_final:s,status:e?.status||De.vx.FINALIZADO}).subscribe({next:o=>{o&&o.length<0?this.toastService.presentToast({titulo:"Sem dados para o filtro de datas",detalhe:`De ${(0,k.Z)(a,"dd/MM/yy")}, at\xe9 ${(0,k.Z)(s,"dd/MM/yy")}`,duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO}):(console.log(o),this.dashboardData=o,this.dashboard=this.dashboardUtilsService.mountClienteDash(o))}});this.subscriptions.add(i)}getTheme(){const{theme:e,dashboard:a}=this.preferencesService.getDashboardTheme(this.dashboard);return this.dashboard=a,e}openHistorico(){this.showModal(O,{cliente_id:this.cliente_id})}openFiltro(){this.showFilter=!0}doFilter(){const e=new Date(this.form.get("dataInicial").value),a=new Date(this.form.get("dataFinal").value),s=this.form.get("status").value;this.loadDash({data_final:a,data_inicial:e,status:s,cliente_id:void 0}),this.showFilter=!1}disableFilterBtn(){return!this.form.valid}isInputError(e){return!(this.form.controls[e].untouched||!this.form.controls[e].errors)}showModal(e,a){var s=this;return(0,w.Z)(function*(){const i=yield s.modalDashCtrl.create({component:e,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:a});return i.onDidDismiss().then(o=>{const{data:v}=o;v&&s.toastService.presentToast({titulo:"Sucesso",detalhe:"Opera\xe7\xe3o bem sucedida!",duracao:c.m4.mediumDuration,gravidade:c.kl.SUCESSO})}),yield i.present()})()}};W.ctorParameters=()=>[{type:V},{type:j.D},{type:te.z},{type:ee.y},{type:u.IN},{type:l.QS}],W.propDecorators={cliente_id:[{type:d.IIB}],defaultDate:[{type:d.IIB}]},W=(0,m.gn)([(0,d.wA2)({selector:"app-cliente-dashboard-servicos",template:'<ng-container *ngIf="dashboardData">\n  <div class="surface-card shadow-2 border-round p-4 mx-auto" style="width: 95vw;">\n    <div class="flex align-items-center justify-content-between mb-3">\n      <div class="text-900 font-medium text-xl">Servi\xe7os Tomados</div>\n      <div>\n        <button pButton pRipple icon="pi pi-ellipsis-v" class="p-button-text p-button-plain p-button-rounded"\n          (click)="dashMenu.toggle($event)"></button>\n        <p-menu #dashMenu [popup]="true" [model]="items" appendTo="body"></p-menu>\n      </div>\n    </div>\n    <div #clienteDash class="flex justify-content-center mb-3">\n      <div class="w-full" echarts [options]="dashboard" [theme]="getTheme()"\n        style="width: 400px; height: 400px; box-shadow: white">\n      </div>\n    </div>\n  </div>\n</ng-container>\n\n\n<p-dialog [(visible)]="showFilter" [resizable]="false" [draggable]="false" [modal]="true"\n  [breakpoints]="{\'960px\': \'75vw\', \'640px\': \'100vw\'}" [style]="{width: \'60vw\', height: \'80%\'}">\n  <ng-template pTemplate="header">\n    <div class="flex align-items-center">\n      <div class="text-900 font-medium mb-3 text-xl">Filtro</div>\n    </div>\n  </ng-template>\n  <div class="surface-card border-round shadow-2 p-4">\n    <form [formGroup]="form" (ngSubmit)="$event.preventDefault()">\n      <div class="grid formgrid p-fluid">\n        <div class="field mb-4 col-12 ">\n          <label for="dataInicial" class="font-medium text-900">Data Inicial</label>\n          <p-calendar id="dataInicial" formControlName="dataInicial" inputId="dateformat" dateFormat="dd/mm/yy"\n            [touchUI]="true"></p-calendar>\n          <div class="flex mt-1 justify-content-end">\n            <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'dataInicial\')"></p-message>\n          </div>\n        </div>\n        <div class="field mb-4 col-12 ">\n          <label for="dataFinal" class="font-medium text-900">Data Final</label>\n          <p-calendar id="dataFinal" formControlName="dataFinal" inputId="dateformat" dateFormat="dd/mm/yy"\n            [touchUI]="true"></p-calendar>\n          <div class="flex mt-1 justify-content-end">\n            <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'dataFinal\')"></p-message>\n          </div>\n        </div>\n        <div class="surface-border border-top-1 opacity-50 mb-4 col-12"></div>\n        <div class="field mb-4 col-12 ">\n          <p-dropdown [options]="statusPedido" placeholder="Status do Pedido" formControlName="status"></p-dropdown>\n        </div>\n      </div>\n    </form>\n  </div>\n  <ng-template pTemplate="footer">\n    <button pButton pRipple label="Filtrar" (click)="doFilter()" [disabled]="disableFilterBtn()"></button>\n  </ng-template>\n</p-dialog>',styles:[""]})],W);let Se=class{};Se=(0,m.gn)([(0,d.LVF)({declarations:[W],imports:[g.ez,l.u5,l.UX,u.Pc,ne.Ns.forRoot({echarts:()=>t.e(7386).then(t.bind(t,77386))}),T.j,xe.TX,G.l,P.hJ,B.T,$.$9,R.S,z._8,U.O,N.kW,_.A,f.o],exports:[W]})],Se);let Z=class{constructor(e,a,s,i,o,v){this.dashboardClientesService=e,this.toastService=a,this.dashboardUtilsService=s,this.preferencesService=i,this.modalDashCtrl=o,this.formBuilder=v,this.items=[{label:"Op\xe7\xf5es",items:[{label:"Filtro",icon:"pi pi-fw pi-filter",command:()=>this.openFiltro()},{label:"Hist\xf3rico",icon:"pi pi-fw pi-money-bill",command:()=>this.openHistorico()}]},{separator:!0},{label:"Exportar como",items:[{label:"PDF",icon:"pi pi-fw pi-file-pdf",command:()=>{this.dashboard?this.dashboard.exportPDF():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}},{label:"CSV",icon:"pi pi-fw pi-file",command:()=>{this.dashboard?this.dashboard.exportCSV():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}},{label:"XLSX",icon:"pi pi-fw pi-file-excel",command:()=>{this.dashboard?this.dashboard.exportXLSX():this.toastService.presentToast({detalhe:"Nenhuma dashboard carregada para exportar",duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO,titulo:"Sem dashboard carregada"})}}]}],this.showFilter=!1,this.statusPedido=D.SX,this.mesPassado=new Date((new Date).getTime()-2592e6),this.subscriptions=new M.w0}ngOnInit(){this.defaultDate||(this.defaultDate=new Date);const{data_inicial:e,data_final:a}=q.E.calcularIntervaloDoMes(this.defaultDate);this.loadDash({cliente_id:void 0,data_inicial:e,data_final:a,status:ye.n.ATIVO}),this.form=this.formBuilder.group({dataInicial:[e,[l.kI.required]],dataFinal:[a,[l.kI.required]],status:[D.$x.FINALIZADO,[l.kI.required]]})}ngOnDestroy(){this.subscriptions.unsubscribe()}loadDash(e){const a=e?.data_inicial||this.mesPassado,s=e?.data_final||new Date,i=this.dashboardClientesService.getAssinaturasDashByCliente({cliente_id:this.cliente_id,data_inicial:a,data_final:s,status:e?.status||ye.n.ATIVO}).subscribe({next:o=>{o&&o.length<0?this.toastService.presentToast({titulo:"Sem dados para o filtro de datas",detalhe:`De ${(0,k.Z)(a,"dd/MM/yy")}, at\xe9 ${(0,k.Z)(s,"dd/MM/yy")}`,duracao:c.m4.shortDuration,gravidade:c.kl.ATENCAO}):(console.log(o),this.dashboardData=o,this.dashboard=this.dashboardUtilsService.mountClienteDash(o))}});this.subscriptions.add(i)}getTheme(){const{theme:e,dashboard:a}=this.preferencesService.getDashboardTheme(this.dashboard);return this.dashboard=a,e}openHistorico(){this.showModal(O,{cliente_id:this.cliente_id})}openFiltro(){this.showFilter=!0}doFilter(){const e=new Date(this.form.get("dataInicial").value),a=new Date(this.form.get("dataFinal").value),s=this.form.get("status").value;this.loadDash({data_final:a,data_inicial:e,status:s,cliente_id:void 0}),this.showFilter=!1}disableFilterBtn(){return!this.form.valid}isInputError(e){return!(this.form.controls[e].untouched||!this.form.controls[e].errors)}showModal(e,a){var s=this;return(0,w.Z)(function*(){const i=yield s.modalDashCtrl.create({component:e,backdropDismiss:!1,cssClass:"modal-size-100",componentProps:a});return i.onDidDismiss().then(o=>{const{data:v}=o;v&&s.toastService.presentToast({titulo:"Sucesso",detalhe:"Opera\xe7\xe3o bem sucedida!",duracao:c.m4.mediumDuration,gravidade:c.kl.SUCESSO})}),yield i.present()})()}};Z.ctorParameters=()=>[{type:V},{type:j.D},{type:te.z},{type:ee.y},{type:u.IN},{type:l.QS}],Z.propDecorators={cliente_id:[{type:d.IIB}],defaultDate:[{type:d.IIB}]},Z=(0,m.gn)([(0,d.wA2)({selector:"app-cliente-dashboard-assinaturas",template:'<ng-container *ngIf="dashboardData">\n  <div class="surface-card shadow-2 border-round p-4 mx-auto" style="width: 95vw;">\n    <div class="flex align-items-center justify-content-between mb-3">\n      <div class="text-900 font-medium text-xl">Assinaturas</div>\n      <div>\n        <button pButton pRipple icon="pi pi-ellipsis-v" class="p-button-text p-button-plain p-button-rounded"\n          (click)="dashMenu.toggle($event)"></button>\n        <p-menu #dashMenu [popup]="true" [model]="items" appendTo="body"></p-menu>\n      </div>\n    </div>\n    <div #clienteDash class="flex justify-content-center mb-3">\n      <div class="w-full" echarts [options]="dashboard" [theme]="getTheme()"\n        style="width: 400px; height: 400px; box-shadow: white">\n      </div>\n    </div>\n  </div>\n</ng-container>\n\n\n<p-dialog [(visible)]="showFilter" [resizable]="false" [draggable]="false" [modal]="true"\n  [breakpoints]="{\'960px\': \'75vw\', \'640px\': \'100vw\'}" [style]="{width: \'60vw\', height: \'80%\'}">\n  <ng-template pTemplate="header">\n    <div class="flex align-items-center">\n      <div class="text-900 font-medium mb-3 text-xl">Filtro</div>\n    </div>\n  </ng-template>\n  <div class="surface-card border-round shadow-2 p-4">\n    <form [formGroup]="form" (ngSubmit)="$event.preventDefault()">\n      <div class="grid formgrid p-fluid">\n        <div class="field mb-4 col-12 ">\n          <label for="dataInicial" class="font-medium text-900">Data Inicial</label>\n          <p-calendar id="dataInicial" formControlName="dataInicial" inputId="dateformat" dateFormat="dd/mm/yy"\n            [touchUI]="true"></p-calendar>\n          <div class="flex mt-1 justify-content-end">\n            <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'dataInicial\')"></p-message>\n          </div>\n        </div>\n        <div class="field mb-4 col-12 ">\n          <label for="dataFinal" class="font-medium text-900">Data Final</label>\n          <p-calendar id="dataFinal" formControlName="dataFinal" inputId="dateformat" dateFormat="dd/mm/yy"\n            [touchUI]="true"></p-calendar>\n          <div class="flex mt-1 justify-content-end">\n            <p-message severity="error" text="Obrigat\xf3rio" *ngIf="isInputError(\'dataFinal\')"></p-message>\n          </div>\n        </div>\n        <div class="surface-border border-top-1 opacity-50 mb-4 col-12"></div>\n        <div class="field mb-4 col-12 ">\n          <p-dropdown [options]="statusPedido" placeholder="Status do Pedido" formControlName="status"></p-dropdown>\n        </div>\n      </div>\n    </form>\n  </div>\n  <ng-template pTemplate="footer">\n    <button pButton pRipple label="Filtrar" (click)="doFilter()" [disabled]="disableFilterBtn()"></button>\n  </ng-template>\n</p-dialog>',styles:[""]})],Z);let Ie=class{};Ie=(0,m.gn)([(0,d.LVF)({declarations:[Z],imports:[g.ez,l.u5,l.UX,u.Pc,ne.Ns.forRoot({echarts:()=>t.e(7386).then(t.bind(t,77386))}),T.j,xe.TX,G.l,P.hJ,B.T,$.$9,R.S,z._8,U.O,N.kW,_.A,f.o],exports:[Z]})],Ie);let re=class{};re=(0,m.gn)([(0,d.LVF)({declarations:[F],imports:[g.ez,l.u5,u.Pc,p.uH,ut.t,P.hJ,mt.EV,$.$9,z._8,B.T,ue.U,ht.S,ne.Ns.forRoot({echarts:()=>t.e(7386).then(t.bind(t,77386))}),ve.x,_.A,f.o,Ce,oe,Se,Ie],exports:[F]})],re);let Oe=class{};Oe=(0,m.gn)([(0,d.LVF)({declarations:[],imports:[g.ez,E.J,ae,se,re],exports:[E.J,ae,se,re]})],Oe);let Ee=class{};Ee=(0,m.gn)([(0,d.LVF)({imports:[g.ez,l.u5,u.Pc,p.uH,f.o,r,Oe],declarations:[n]})],Ee)},94567:(Q,C,t)=>{t.d(C,{OL:()=>l,eX:()=>d,r6:()=>u});var d,p,g,m=t(46007);(p=d||(d={})).OPERANDO="OPERANDO",p.FECHADA_TEMPORARIAMENTE="FECHADA_TEMPORARIAMENTE",p.FECHADA_PERMANENTEMENTE="FECHADA_PERMANENTEMENTE",p.DELETADA="DELETADA",function(p){p.LOJA_FISICA="LOJA_FISICA",p.LOJA_DIGITAL="LOJA_DIGITAL",p.FILIAL="FILIAL",p.ARMAZEM="ARMAZEM",p.QUIOSQUE="QUIOSQUE",p.BOUTIQUE="BOUTIQUE",p.POP_UP_STORE="POP_UP_STORE",p.OUTLET="OUTLET",p.SHOWROOM="SHOWROOM",p.CONCEITO_STORE="CONCEITO_STORE",p.DEPARTAMENTO="DEPARTAMENTO",p.OUTRO="OUTRO"}(g||(g={}));const l=m.m.convertEnumToSelectItem(d),u=m.m.convertEnumToSelectItem(g)},42480:(Q,C,t)=>{t.d(C,{R:()=>S});var m=t(70655),d=t(98274),g=t(36895);let l=class{transform(n,...h){if("string"==typeof n&&11==n.trim().length){let r=n.replace(/\D/g,"");return r=r.replace(/(\d{3})(\d)/,"$1.$2"),r=r.replace(/(\d{3})(\d)/,"$1.$2"),r=r.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),r}return n}};l=(0,m.gn)([(0,d.E6H)({name:"cpfMask"})],l);let u=class{transform(n,...h){return n}};u=(0,m.gn)([(0,d.E6H)({name:"cepMask"})],u);let p=class{transform(n,...h){return n?n.length<11?n:n.includes("0800")?this.transform0800(n):this.transformCelular(n):""}transformCelular(n){const h=n.substring(0,2),r=n.substring(2,3),f=n.substring(3,7),E=n.substring(7,11);return n.length<=2?`(${h})`:n.length<=3?`(${h})${r}`:n.length<=7?`(${h})${r} ${f}`:`(${h})${r} ${f}-${E}`}transform0800(n){return`${n.slice(0,4)} ${n.slice(4,7)} ${n.slice(7)}`}};p=(0,m.gn)([(0,d.E6H)({name:"phoneMask"})],p);let y=class{transform(n,...h){if("string"==typeof n&&14===n.trim().length){let r=n.replace(/\D/g,"");return r=r.replace(/^(\d{2})(\d)/,"$1.$2"),r=r.replace(/^(\d{2})\.(\d{3})(\d)/,"$1.$2.$3"),r=r.replace(/\.(\d{3})(\d)/,".$1/$2"),r=r.replace(/(\d{4})(\d)/,"$1-$2"),r}return n}};y=(0,m.gn)([(0,d.E6H)({name:"cnpjMask"})],y);let S=class{};S=(0,m.gn)([(0,d.LVF)({declarations:[l,u,p,y],imports:[g.ez],exports:[l,u,p,y]})],S)},68488:(Q,C,t)=>{t.d(C,{Y:()=>S});var m=t(70655),d=t(80529),g=t(98274),l=t(99038),u=t(40199),p=t(55583),y=t(67578);let S=class{constructor(n){this.http=n}findById(n){return this.http.get(`${l.Hz.baseURL}/clientes/${n}`,{responseType:"json"})}list(n,h=new u.k){let r=p.t.getPageOptionsParams(h);return n&&n.searchedCliente&&(r=r.append("searchedCliente",n.searchedCliente)),n&&n.status_pessoa&&(r=r.append("status_pessoa",n.status_pessoa)),n&&n.status_user&&(r=r.append("status_user",n.status_user)),n&&n.nome&&(r=r.append("nome",n.nome)),n&&n.cpf&&(r=r.append("cpf",n.cpf)),n&&n.email&&(r=r.append("email",n.email)),n&&n.loja_id&&(r=r.append("loja_id",n.loja_id)),this.http.get(`${l.Hz.baseURL}/clientes`,{responseType:"json",params:r})}create(n){const{tel1:h,tel2:r,email_alternativo:f,cpf:E}=n;return n=y.f.sanitizeCreate({tel1:h,tel2:r,email_alternativo:f,cpf:E},n),this.http.post(`${l.Hz.baseURL}/clientes`,n,{responseType:"json"})}update(n,h){const{tel1:r,tel2:f,email_alternativo:E}=n;return n=y.f.sanitizeCreate({tel1:r,tel2:f,email_alternativo:E,cpf:void 0},n),this.http.put(`${l.Hz.baseURL}/clientes/${h}`,n,{responseType:"json"})}createEndereco(n,h){return this.http.post(`${l.Hz.baseURL}/clientes/${h}/endereco`,n,{responseType:"json"})}updateEndereco(n,h){return this.http.post(`${l.Hz.baseURL}/clientes/${h}/endereco`,n,{responseType:"json"})}updatePassword(n){return this.http.patch(`${l.Hz.baseURL}/users/password`,{senha:n},{responseType:"json"})}uploadAvatar(n,h){const r=new FormData;r.append("file",n);const f=h?`${l.Hz.baseURL}/clientes/${h}/avatar`:`${l.Hz.baseURL}/clientes/avatar`;return this.http.patch(f,r)}};S.ctorParameters=()=>[{type:d.eN}],S=(0,m.gn)([(0,g.GSi)({providedIn:"root"})],S)},32470:(Q,C,t)=>{t.d(C,{P:()=>y});var m=t(94327),g=t(53583),l=t(12983),u=t.n(l),p=t(80574);class y{static exportPdf(x,n,h){const r=new g.default("l","mm","a4");u()(r,{head:[n],body:h,didDrawCell:f=>{}}),r.save(`${x}.pdf`)}static exportExcel(x,n){const r={Sheets:{data:p.P6.json_to_sheet(n)},SheetNames:["data"]},f=p.cW(r,{bookType:"xlsx",type:"array"});this.saveAsExcelFile(f,x)}static exportCSV(x,n){const r={Sheets:{data:p.P6.json_to_sheet(n)},SheetNames:["data"]},f=p.cW(r,{bookType:"csv",type:"array"});this.saveAsCsvFile(f,x)}static saveAsExcelFile(x,n){const f=new Blob([x],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});m.saveAs(f,n+".xlsx")}static saveAsCsvFile(x,n){const f=new Blob([x],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8"});m.saveAs(f,n+".csv")}}},67578:(Q,C,t)=>{t.d(C,{f:()=>g});var m=t(34057),d=t(35326);class g{static sanitizeCreate(u,p){return p.tel1=d.r.ClearSpecialCharacters(u.tel1),p.tel2=d.r.ClearSpecialCharacters(u.tel2),(!u.tel1||0==u.tel1?.length)&&(p.tel1=void 0),(!u.tel2||0==u.tel2?.length)&&(p.tel2=void 0),(!u.cpf||""==u.cpf)&&(p.cpf=void 0),(!u.email_alternativo||""==u.email_alternativo)&&(p.email_alternativo=void 0),p}static checkUpdateImagePermission(u){return u==m.u.GERENTE||u==m.u.ADMIN}}}}]);