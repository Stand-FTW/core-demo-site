"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[76],{20533:(v,l,e)=>{e.d(l,{Y:()=>f});var s=e(70655);var m=e(42732),c=e(98274),n=e(24006),d=e(48058),g=e(50727),a=e(59136),h=e(59256),t=e(93922),A=e(2435),C=e(16137),P=e(34758),b=e(60874);let f=class{constructor(o,i,u,_,I,E,O){this.formBuilder=o,this.modal=i,this.assinaturaService=u,this.toastService=_,this.userService=I,this.planoService=E,this.cartaoClientesService=O,this.isLoaded=!1,this.searchedCliente="",this.selectedClienteId="",this.formasPagamento=C.q,this.enableCartaoView=!1,this.modalidadesPagamento=[],this.createdAssinaturaItemId="",this.wasCreated=!1,this.subscriptions=new g.w0}ngOnInit(){this.loadAssinatura()}ngOnDestroy(){this.subscriptions.unsubscribe()}create(){const o=this.form.get("forma_pagamento").value,i=this.form.get("modalidade").value,u=this.form.get("cartao_cliente_id").value||void 0,I={modalidade:i,plano_assinatura_id:this.plano.id,forma_pagamento:{tipo:o,cartao_cliente_id:u||void 0}},E=this.assinaturaService.update(this.assinatura_id,I).subscribe(O=>{this.createdAssinaturaItemId=O.id,this.wasCreated=!0,this.fechar()});this.subscriptions.add(E)}enableCartaoCliente({value:o}){const i=o;i==C.t.CARTAO_CREDITO||i==C.t.CARTAO_DEBITO?(this.enableCartaoView=!0,this.form.get("cartao_cliente_id").setValidators([n.kI.required])):(this.enableCartaoView=!1,this.form.get("cartao_cliente_id").setValue(void 0),this.form.get("cartao_cliente_id").clearValidators()),this.form.get("cartao_cliente_id").updateValueAndValidity({onlySelf:!0}),this.form.updateValueAndValidity()}loadCartao(o=1){const i=this.cartaoClientesService.list({cliente_id:this.selectedClienteId},{order:a.L.DESC,page:o,take:10}).subscribe(u=>{this.cartoes=u});this.subscriptions.add(i)}paginarCartao(o){this.loadCartao()}onCartaoFilter(o){const i=o.filter;this.searchedCliente=i}blurCartao(o,i){this.searchedCliente=void 0,i.filterValue=void 0}cadastrarCartao(){}loadPlano(){const{id:o}=this.assinatura.plano_assinatura,i=this.planoService.findById(o).subscribe(u=>{this.plano=u,this.generateModalidade()});this.subscriptions.add(i)}loadAssinatura(){const o=this.assinaturaService.findById(this.assinatura_id).subscribe(i=>{this.assinatura=i,this.selectedClienteId=i.assinante.id,this.loadCartao(),this.loadPlano();const{forma_pagamento:u,modalidade:_}=this.assinatura;this.form=this.formBuilder.group({forma_pagamento:[u.tipo,[n.kI.required]],modalidade:[_,[n.kI.required]],cartao_cliente_id:[u.cartao_cliente?.id||void 0,[]]}),this.enableCartaoCliente({value:u.tipo})});this.subscriptions.add(o)}generateModalidade(){const{valor_mensal:o,valor_trimestral:i,valor_semestral:u,valor_anual:_}=this.plano;this.modalidadesPagamento.push({modalidade:b._.MENSAL,label:`Mensal - R$ ${Number(o).toFixed(2)}`}),i&&this.modalidadesPagamento.push({modalidade:b._.TRIMESTRAL,label:`Trimestral - R$ ${Number(i).toFixed(2)}`}),u&&this.modalidadesPagamento.push({modalidade:b._.SEMESTRAL,label:`Semestral - R$ ${Number(u).toFixed(2)}`}),_&&this.modalidadesPagamento.push({modalidade:b._.ANUAL,label:`Anual - R$ ${Number(_).toFixed(2)}`})}fechar(){this.modal.dismiss(this.wasCreated)}isInputError(o){return!(this.form.controls[o].untouched||!this.form.controls[o].errors)}disableCreateBtn(){return!this.form.valid}};f.ctorParameters=()=>[{type:n.QS},{type:d.IN},{type:t.d},{type:h.D},{type:P.K},{type:m.w},{type:A.q}],f.propDecorators={assinatura_id:[{type:c.IIB}]},f=(0,s.gn)([(0,c.wA2)({selector:"app-assinaturas-update",template:'<ion-content appScrollTheme>\n  <ng-container *ngIf="assinatura && form && plano">\n    <form [formGroup]="form" (ngSubmit)="$event.preventDefault()">\n\n      <div class="surface-ground px-4 py-8 md:px-6 lg:px-8">\n        <div class="text-900 font-medium text-xl mb-3">Atualizar</div>\n        <div class="surface-card p-4 shadow-2 border-round p-fluid">\n          <div class="grid formgrid p-fluid">\n\n            <div class="col-12 field mb-5">\n              <label for="clients" class="text-900 font-medium mb-3">Plano</label>\n              <input id="nome" type="text" disabled pInputText [(ngModel)]="assinatura.plano_assinatura.nome"\n                [ngModelOptions]="{standalone: true}">\n            </div>\n            <div class="col-12 field mb-5">\n              <label for="clients" class="text-900 font-medium mb-3">Cliente</label>\n              <input id="nome" type="text" disabled pInputText [(ngModel)]="assinatura.assinante.nome"\n                [ngModelOptions]="{standalone: true}">\n            </div>\n            <p-divider class="w-full px-2 mb-3"></p-divider>\n\n            <div *ngIf="modalidadesPagamento" class="col-12 field">\n              <label for="modalidade" class="text-900 font-medium mb-2 font-bold">Modalidade</label>\n              <p-dropdown id="modalidade" [options]="modalidadesPagamento" formControlName="modalidade"\n                placeholder="Modalidade de assinatura" optionValue="modalidade" optionLabel="label">\n              </p-dropdown>\n            </div>\n            <p-divider class="w-full px-2 mb-3"></p-divider>\n\n            <div class="col-12 field">\n              <label for="forma_pagamento" class="text-900 font-medium mb-2 font-bold">Forma de pagamento</label>\n              <p-dropdown id="forma_pagamento" [options]="formasPagamento" formControlName="forma_pagamento"\n                placeholder="Forma de pagamento" (onChange)="enableCartaoCliente($event); loadCartao()">\n              </p-dropdown>\n            </div>\n            <p-divider class="w-full px-2 mb-3"></p-divider>\n\n            <ng-container *ngIf="enableCartaoView">\n              <div *ngIf="cartoes" class="col-12 field">\n                <label for="cartoes" class="text-900 font-medium mb-3">Cart\xe3o final</label>\n                <p-dropdown id="cartoes" #drop_client [options]="cartoes.data" formControlName="cartao_cliente_id"\n                  [filter]="true" placeholder="Selecione um cart\xe3o" optionValue="id" optionLabel="ultimos_digitos"\n                  [virtualScroll]="true" [virtualScrollItemSize]="38" [lazy]="true"\n                  (onLazyLoad)="paginarCartao($event)" (onFilter)="onCartaoFilter($event)"\n                  (onFocus)="blurCartao($event, drop_client)">\n                  <ng-template pTemplate="loader" let-options="options">\n                    <div class="flex align-items-center py-2 px-3" style="height: 38px">\n                      <p-skeleton [width]="options.even ? \'60%\' : \'50%\'" height="1rem"></p-skeleton>\n                    </div>\n                  </ng-template>\n                  <ng-template let-c pTemplate="item">\n                    <div>{{"Final: " + c.ultimos_digitos }}</div>\n                  </ng-template>\n                </p-dropdown>\n              </div>\n              <div *ngIf="!cartoes" class="col-12 field">\n                <div class="mt-3 lg:mt-0">\n                  <span class="text-600 mr-2">Cliente sem cart\xf5es cadastrados!</span>\n                  <a tabindex="0" (click)="cadastrarCartao()"\n                    class="cursor-pointer text-900 hover:text-primary transition-duration-150">Clique\n                    aqui para cadastrar um novo</a>\n                </div>\n              </div>\n              <p-divider class="w-full px-2 mb-3"></p-divider>\n            </ng-container>\n\n          </div>\n          <div class="flex justify-content-end">\n            <button pButton pRipple label="Atualizar" icon="pi pi-send" iconPos="right" class="w-auto" (click)="create()"\n              [disabled]="disableCreateBtn()"></button>\n          </div>\n        </div>\n\n      </div>\n\n    </form>\n  </ng-container>\n</ion-content>\n\n<ion-footer>\n  <ion-toolbar>\n    <ion-button expand="full" color="danger" (click)="fechar()">Fechar</ion-button>\n  </ion-toolbar>\n</ion-footer>',styles:[""]})],f)},91670:(v,l,e)=>{e.d(l,{A:()=>d});var s=e(70655);var m=e(98274);let c=class{constructor(){}ngOnInit(){}};c.ctorParameters=()=>[],c.propDecorators={title:[{type:m.IIB}],subtitle:[{type:m.IIB}],message:[{type:m.IIB}]},c=(0,s.gn)([(0,m.wA2)({selector:"app-attention-surface",template:'<div class="surface-ground px-4 py-4 md:px-6 lg:px-8 h-full">\n  <div\n    style="background: radial-gradient(50% 109137.91% at 50% 50%, rgba(233, 203, 30, 0.1) 0%, rgba(254, 253, 244, 0) 100%);"\n    class="text-center">\n    <span class="bg-surface-50 text-yellow-500 font-bold text-2xl inline-block px-3">{{ title }}</span>\n  </div>\n  <div class="mt-6 mb-5 font-bold text-6xl text-900 text-center">{{ subtitle }}</div>\n  <p class="text-700 text-3xl mt-0 mb-6 text-center">{{ message }}</p>\n</div>',styles:[""]})],c);var n=e(36895);let d=class{};d=(0,s.gn)([(0,m.LVF)({declarations:[c],imports:[n.ez],exports:[c]})],d)},60874:(v,l,e)=>{var s,r;e.d(l,{_:()=>s}),(r=s||(s={})).MENSAL="MENSAL",r.TRIMESTRAL="TRIMESTRAL",r.SEMESTRAL="SEMESTRAL",r.ANUAL="ANUAL"},16137:(v,l,e)=>{var s,p;e.d(l,{q:()=>r,t:()=>s}),(p=s||(s={})).DINHEIRO="DINHEIRO",p.CARTAO_CREDITO="CARTAO_CREDITO",p.CARTAO_DEBITO="CARTAO_DEBITO",p.PIX="PIX",p.BOLETO="BOLETO";const r=[{label:"Dinheiro",value:s.DINHEIRO},{label:"Cart\xe3o de Cr\xe9dito",value:s.CARTAO_CREDITO},{label:"Cart\xe3o de D\xe9bito",value:s.CARTAO_DEBITO},{label:"PIX",value:s.PIX},{label:"Boleto",value:s.BOLETO}]},18109:(v,l,e)=>{var s,r;e.d(l,{X:()=>s}),(r=s||(s={})).FUNCIONARIO="FUNCIONARIO",r.CLIENTE="CLIENTE"},93922:(v,l,e)=>{e.d(l,{d:()=>d});var s=e(70655),r=e(80529),p=e(98274),m=e(40199),c=e(55583),n=e(99038);let d=class{constructor(a){this.http=a}list(a,h=new m.k){let t=c.t.getPageOptionsParams(h);return a&&a.assinante_id&&(t=t.append("assinante_id",a.assinante_id)),a&&a.modalidade&&(t=t.append("modalidade",a.modalidade)),a&&a.status&&(t=t.append("status",a.status)),a&&a.searchedAssinatura&&(t=t.append("searchedAssinatura",a.searchedAssinatura)),a&&a.plano_assinatura_id&&(t=t.append("plano_assinatura_id",a.plano_assinatura_id)),a&&a.searchedAssinante&&(t=t.append("searchedAssinante",a.searchedAssinante)),a&&a.searchedPlano&&(t=t.append("searchedPlano",a.searchedPlano)),a&&a.created_at&&(t=t.append("created_at",a.created_at.toDateString())),this.http.get(`${n.Hz.baseURL}/assinaturas`,{responseType:"json",params:t})}findById(a){return this.http.get(`${n.Hz.baseURL}/assinaturas/${a}`,{responseType:"json"})}create(a){return this.http.post(`${n.Hz.baseURL}/assinaturas`,a,{responseType:"json"})}update(a,h){return this.http.put(`${n.Hz.baseURL}/assinaturas/${a}`,h,{responseType:"json"})}startById(a){return this.http.patch(`${n.Hz.baseURL}/assinaturas/${a}/ativo`,{responseType:"json"})}cancelById(a){return this.http.delete(`${n.Hz.baseURL}/assinaturas/${a}`,{responseType:"json"})}pendenteById(a){return this.http.patch(`${n.Hz.baseURL}/assinaturas/${a}/pendente`,{responseType:"json"})}pausadaById(a){return this.http.patch(`${n.Hz.baseURL}/assinaturas/${a}/pausada`,{responseType:"json"})}};d.ctorParameters=()=>[{type:r.eN}],d=(0,s.gn)([(0,p.GSi)({providedIn:"root"})],d)},42732:(v,l,e)=>{e.d(l,{w:()=>d});var s=e(70655),r=e(80529),p=e(98274),m=e(40199),c=e(55583),n=e(99038);let d=class{constructor(a){this.http=a}list(a,h=new m.k){let t=c.t.getPageOptionsParams(h);return a&&a.nome&&(t=t.append("nome",a.nome)),a&&a.descricao&&(t=t.append("descricao",a.descricao)),a&&a.searchedPlano&&(t=t.append("searchedPlano",a.searchedPlano)),a&&a.created_at&&(t=t.append("created_at",a.created_at.toDateString())),this.http.get(`${n.Hz.baseURL}/planos`,{responseType:"json",params:t})}findById(a){return this.http.get(`${n.Hz.baseURL}/planos/${a}`,{responseType:"json"})}create(a){return this.http.post(`${n.Hz.baseURL}/planos`,a,{responseType:"json"})}update(a,h){return this.http.put(`${n.Hz.baseURL}/planos/${a}`,h,{responseType:"json"})}};d.ctorParameters=()=>[{type:r.eN}],d=(0,s.gn)([(0,p.GSi)({providedIn:"root"})],d)},2435:(v,l,e)=>{e.d(l,{q:()=>d});var s=e(70655),r=e(80529),p=e(98274),m=e(40199),c=e(55583),n=e(99038);let d=class{constructor(a){this.http=a}list(a,h=new m.k){let t=c.t.getPageOptionsParams(h);return a&&a.cliente_id&&(t=t.append("cliente_id",a.cliente_id)),a&&a.status&&(t=t.append("status",a.status)),a&&a.tipo&&(t=t.append("tipo",a.tipo)),a&&a.user_registrou_id&&(t=t.append("user_registrou_id",a.user_registrou_id)),this.http.get(`${n.Hz.baseURL}/cartao-clientes`,{responseType:"json",params:t})}findById(a){return this.http.get(`${n.Hz.baseURL}/cartao-clientes/${a}`,{responseType:"json"})}create(a){return this.http.post(`${n.Hz.baseURL}/cartao-clientes`,a,{responseType:"json"})}};d.ctorParameters=()=>[{type:r.eN}],d=(0,s.gn)([(0,p.GSi)({providedIn:"root"})],d)}}]);